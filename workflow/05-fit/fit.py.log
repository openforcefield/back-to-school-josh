2025-09-11 14:51:42.814 | INFO     | __main__:main:78 - ---------------------- starting script ----------------------
2025-09-11 14:52:53.168 | INFO     | __main__:main:78 - ---------------------- starting script ----------------------
2025-09-11 14:52:53.168 | INFO     | __main__:main:80 - Loading tensor force field
2025-09-11 14:52:58.987 | INFO     | __main__:main:83 - Loading tensor topologies
2025-09-11 14:53:27.134 | INFO     | __main__:main:89 - Loading training dataset(s)
2025-09-11 14:53:27.303 | INFO     | __main__:main:94 - Loading test dataset(s)
2025-09-11 14:53:27.316 | ERROR    | __main__:<module>:266 - An error has been caught in function '<module>', process 'MainProcess' (41741), thread 'MainThread' (139865171969856):
Traceback (most recent call last):

> File "/home/joshmitchell/Documents/openff/back-to-school-josh/workflow/05-fit/fit.py", line 267, in <module>
    app()
    └ App(name=('fit',), help='\nTODO: Write me!\n\n**Input files:**\n\nFile 1\n    File 1 description\n\nFile 2\n    File 2 descri...

  File "/home/joshmitchell/Documents/openff/back-to-school-josh/.pixi/envs/default/lib/python3.12/site-packages/cyclopts/core.py", line 1293, in __call__
    return command(*bound.args, **bound.kwargs)
           │        │     │       │     └ <property object at 0x7f34e4b1b600>
           │        │     │       └ <BoundArguments (tensor_ff_path=PosixPath('../04-parametrize/outputs/tensor_ff.pt'), tensor_tops_path=PosixPath('../04-parame...
           │        │     └ <property object at 0x7f34e4b1b5b0>
           │        └ <BoundArguments (tensor_ff_path=PosixPath('../04-parametrize/outputs/tensor_ff.pt'), tensor_tops_path=PosixPath('../04-parame...
           └ <function main at 0x7f34e5721260>

  File "/home/joshmitchell/Documents/openff/back-to-school-josh/workflow/05-fit/fit.py", line 101, in main
    trainable = descent.train.Trainable(
                │       │     └ <class 'descent.train.Trainable'>
                │       └ <module 'descent.train' from '/home/joshmitchell/Documents/openff/back-to-school-josh/.pixi/envs/default/lib/python3.12/site-...
                └ <module 'descent' from '/home/joshmitchell/Documents/openff/back-to-school-josh/.pixi/envs/default/lib/python3.12/site-packag...

  File "/home/joshmitchell/Documents/openff/back-to-school-josh/.pixi/envs/default/lib/python3.12/site-packages/descent/train.py", line 318, in __init__
    ) = self._prepare(force_field, parameters, "parameters")
        │    │        │            └ [{'Bonds': {'cols': ['k', 'length'], 'scales': {'k': 0.01, 'length': 1.0}, 'limits': {'k': [0.0, None], 'length': [0.0, None]...
        │    │        └ TensorForceField(potentials=[TensorPotential(type='Angles', fn='k/2*(theta-angle)**2', parameters=tensor([[275.1660,   1.7158...
        │    └ <classmethod(<function Trainable._prepare at 0x7f346382d080>)>
        └ <descent.train.Trainable object at 0x7f3463869dc0>
  File "/home/joshmitchell/Documents/openff/back-to-school-josh/.pixi/envs/default/lib/python3.12/site-packages/descent/train.py", line 196, in _prepare
    force_field.potentials_by_type[potential_type]
    │           └ <property object at 0x7f34a30fef70>
    └ TensorForceField(potentials=[TensorPotential(type='Angles', fn='k/2*(theta-angle)**2', parameters=tensor([[275.1660,   1.7158...

TypeError: unhashable type: 'dict'
2025-09-11 14:54:55.412 | INFO     | __main__:main:78 - ---------------------- starting script ----------------------
2025-09-11 14:54:55.412 | INFO     | __main__:main:80 - Loading tensor force field
2025-09-11 14:55:00.748 | INFO     | __main__:main:83 - Loading tensor topologies
2025-09-11 14:55:20.205 | INFO     | __main__:main:89 - Loading training dataset(s)
2025-09-11 14:55:20.255 | INFO     | __main__:main:94 - Loading test dataset(s)
2025-09-11 14:55:20.264 | INFO     | __main__:main:101 - Training config: {'parameters': [{'Bonds': {'cols': ['k', 'length'], 'scales': {'k': 0.01, 'length': 1.0}, 'limits': {'k': [0.0, None], 'length': [0.0, None]}}, 'Angles': {'cols': ['k', 'angle'], 'scales': {'k': 0.01, 'angle': 1.0}, 'limits': {'k': [0.0, None], 'angle': [0.0, 3.141592653589793]}}, 'ProperTorsions': {'cols': ['k'], 'scales': {'k': 0.01}, 'limits': {'k': [0.0, None]}}}], 'attributes': []}
2025-09-11 14:55:20.264 | ERROR    | __main__:<module>:268 - An error has been caught in function '<module>', process 'MainProcess' (41919), thread 'MainThread' (140578247681856):
Traceback (most recent call last):

> File "/home/joshmitchell/Documents/openff/back-to-school-josh/workflow/05-fit/fit.py", line 269, in <module>
    app()
    └ App(name=('fit',), help='\nTODO: Write me!\n\n**Input files:**\n\nFile 1\n    File 1 description\n\nFile 2\n    File 2 descri...

  File "/home/joshmitchell/Documents/openff/back-to-school-josh/.pixi/envs/default/lib/python3.12/site-packages/cyclopts/core.py", line 1293, in __call__
    return command(*bound.args, **bound.kwargs)
           │        │     │       │     └ <property object at 0x7fdaeb51b5b0>
           │        │     │       └ <BoundArguments (tensor_ff_path=PosixPath('../04-parametrize/outputs/tensor_ff.pt'), tensor_tops_path=PosixPath('../04-parame...
           │        │     └ <property object at 0x7fdaeb51b560>
           │        └ <BoundArguments (tensor_ff_path=PosixPath('../04-parametrize/outputs/tensor_ff.pt'), tensor_tops_path=PosixPath('../04-parame...
           └ <function main at 0x7fdaec122160>

  File "/home/joshmitchell/Documents/openff/back-to-school-josh/workflow/05-fit/fit.py", line 103, in main
    trainable = descent.train.Trainable(
                │       │     └ <class 'descent.train.Trainable'>
                │       └ <module 'descent.train' from '/home/joshmitchell/Documents/openff/back-to-school-josh/.pixi/envs/default/lib/python3.12/site-...
                └ <module 'descent' from '/home/joshmitchell/Documents/openff/back-to-school-josh/.pixi/envs/default/lib/python3.12/site-packag...

  File "/home/joshmitchell/Documents/openff/back-to-school-josh/.pixi/envs/default/lib/python3.12/site-packages/descent/train.py", line 318, in __init__
    ) = self._prepare(force_field, parameters, "parameters")
        │    │        │            └ [{'Bonds': {'cols': ['k', 'length'], 'scales': {'k': 0.01, 'length': 1.0}, 'limits': {'k': [0.0, None], 'length': [0.0, None]...
        │    │        └ TensorForceField(potentials=[TensorPotential(type='Angles', fn='k/2*(theta-angle)**2', parameters=tensor([[275.1660,   1.7158...
        │    └ <classmethod(<function Trainable._prepare at 0x7fda6a23d120>)>
        └ <descent.train.Trainable object at 0x7fda84072600>
  File "/home/joshmitchell/Documents/openff/back-to-school-josh/.pixi/envs/default/lib/python3.12/site-packages/descent/train.py", line 196, in _prepare
    force_field.potentials_by_type[potential_type]
    │           └ <property object at 0x7fdaa980eed0>
    └ TensorForceField(potentials=[TensorPotential(type='Angles', fn='k/2*(theta-angle)**2', parameters=tensor([[275.1660,   1.7158...

TypeError: unhashable type: 'dict'
2025-09-11 14:56:37.994 | INFO     | __main__:main:79 - ---------------------- starting script ----------------------
2025-09-11 14:56:37.995 | INFO     | __main__:main:81 - Loading tensor force field
2025-09-11 14:56:43.343 | INFO     | __main__:main:84 - Loading tensor topologies
2025-09-11 14:57:03.258 | INFO     | __main__:main:90 - Loading training dataset(s)
2025-09-11 14:57:03.309 | INFO     | __main__:main:95 - Loading test dataset(s)
2025-09-11 14:57:03.319 | INFO     | __main__:main:102 - Training config: {'attributes': [],
 'parameters': [{'Angles': {'cols': ['k', 'angle'],
                            'limits': {'angle': [0.0, 3.141592653589793],
                                       'k': [0.0, None]},
                            'scales': {'angle': 1.0, 'k': 0.01}},
                 'Bonds': {'cols': ['k', 'length'],
                           'limits': {'k': [0.0, None], 'length': [0.0, None]},
                           'scales': {'k': 0.01, 'length': 1.0}},
                 'ProperTorsions': {'cols': ['k'],
                                    'limits': {'k': [0.0, None]},
                                    'scales': {'k': 0.01}}}]}
2025-09-11 14:57:03.319 | ERROR    | __main__:<module>:269 - An error has been caught in function '<module>', process 'MainProcess' (42152), thread 'MainThread' (139734960998208):
Traceback (most recent call last):

> File "/home/joshmitchell/Documents/openff/back-to-school-josh/workflow/05-fit/fit.py", line 270, in <module>
    app()
    └ App(name=('fit',), help='\nTODO: Write me!\n\n**Input files:**\n\nFile 1\n    File 1 description\n\nFile 2\n    File 2 descri...

  File "/home/joshmitchell/Documents/openff/back-to-school-josh/.pixi/envs/default/lib/python3.12/site-packages/cyclopts/core.py", line 1293, in __call__
    return command(*bound.args, **bound.kwargs)
           │        │     │       │     └ <property object at 0x7f16941e5e40>
           │        │     │       └ <BoundArguments (tensor_ff_path=PosixPath('../04-parametrize/outputs/tensor_ff.pt'), tensor_tops_path=PosixPath('../04-parame...
           │        │     └ <property object at 0x7f16941e5df0>
           │        └ <BoundArguments (tensor_ff_path=PosixPath('../04-parametrize/outputs/tensor_ff.pt'), tensor_tops_path=PosixPath('../04-parame...
           └ <function main at 0x7f1694722160>

  File "/home/joshmitchell/Documents/openff/back-to-school-josh/workflow/05-fit/fit.py", line 104, in main
    trainable = descent.train.Trainable(
                │       │     └ <class 'descent.train.Trainable'>
                │       └ <module 'descent.train' from '/home/joshmitchell/Documents/openff/back-to-school-josh/.pixi/envs/default/lib/python3.12/site-...
                └ <module 'descent' from '/home/joshmitchell/Documents/openff/back-to-school-josh/.pixi/envs/default/lib/python3.12/site-packag...

  File "/home/joshmitchell/Documents/openff/back-to-school-josh/.pixi/envs/default/lib/python3.12/site-packages/descent/train.py", line 318, in __init__
    ) = self._prepare(force_field, parameters, "parameters")
        │    │        │            └ [{'Bonds': {'cols': ['k', 'length'], 'scales': {'k': 0.01, 'length': 1.0}, 'limits': {'k': [0.0, None], 'length': [0.0, None]...
        │    │        └ TensorForceField(potentials=[TensorPotential(type='Angles', fn='k/2*(theta-angle)**2', parameters=tensor([[275.1660,   1.7158...
        │    └ <classmethod(<function Trainable._prepare at 0x7f1612aad120>)>
        └ <descent.train.Trainable object at 0x7f162b0d4800>
  File "/home/joshmitchell/Documents/openff/back-to-school-josh/.pixi/envs/default/lib/python3.12/site-packages/descent/train.py", line 196, in _prepare
    force_field.potentials_by_type[potential_type]
    │           └ <property object at 0x7f1651c02f20>
    └ TensorForceField(potentials=[TensorPotential(type='Angles', fn='k/2*(theta-angle)**2', parameters=tensor([[275.1660,   1.7158...

TypeError: unhashable type: 'dict'
2025-09-11 14:59:23.618 | INFO     | __main__:main:79 - ---------------------- starting script ----------------------
2025-09-11 14:59:23.619 | INFO     | __main__:main:81 - Loading tensor force field
2025-09-11 14:59:28.963 | INFO     | __main__:main:84 - Loading tensor topologies
2025-09-11 14:59:48.581 | INFO     | __main__:main:90 - Loading training dataset(s)
2025-09-11 14:59:48.631 | INFO     | __main__:main:95 - Loading test dataset(s)
2025-09-11 14:59:48.642 | INFO     | __main__:main:102 - Training config: {'attributes': {},
 'parameters': {'Angles': {'cols': ['k', 'angle'],
                           'limits': {'angle': [0.0, 3.141592653589793],
                                      'k': [0.0, None]},
                           'scales': {'angle': 1.0, 'k': 0.01}},
                'Bonds': {'cols': ['k', 'length'],
                          'limits': {'k': [0.0, None], 'length': [0.0, None]},
                          'scales': {'k': 0.01, 'length': 1.0}},
                'ProperTorsions': {'cols': ['k'],
                                   'limits': {'k': [0.0, None]},
                                   'scales': {'k': 0.01}}}}
2025-09-11 14:59:48.654 | INFO     | __main__:train_force_field:177 - Training on cpu
2025-09-11 14:59:48.654 | INFO     | __main__:train_force_field:179 - Start training...
2025-09-11 15:14:22.639 | INFO     | __main__:main:79 - ---------------------- starting script ----------------------
2025-09-11 15:14:22.639 | INFO     | __main__:main:81 - Loading tensor force field
2025-09-11 15:14:27.992 | INFO     | __main__:main:84 - Loading tensor topologies
2025-09-11 15:14:47.236 | INFO     | __main__:main:90 - Loading training dataset(s)
2025-09-11 15:14:47.286 | INFO     | __main__:main:95 - Checking training dataset(s)
2025-09-11 15:14:48.606 | WARNING  | __main__:remove_missing_rows:141 - Skipping some SMILES because their topologies do not exist:
    [F:1][P:4]([F:2])[I:3]
    [N:1]#[C:3][S:4][I:2]
    [I:1][P:21]([I:2])([c:18]1[c:12]([H:31])[c:6]([H:25])[c:3]([H:22])[c:7]([H:26])[c:13]1[H:32])([c:19]1[c:14]([H:33])[c:8]([H:27])[c:4]([H:23])[c:9]([H:28])[c:15]1[H:34])[c:20]1[c:16]([H:35])[c:10]([H:29])[c:5]([H:24])[c:11]([H:30])[c:17]1[H:36]
    [Br:1][S:4][c:16]1[c:13]([H:25])[c:9]([H:21])[c:8]([H:20])[c:12]([H:24])[c:15]1/[N:3]=[N:2]/[c:14]1[c:10]([H:22])[c:6]([H:18])[c:5]([H:17])[c:7]([H:19])[c:11]1[H:23]
    [I:1][P:13]([S:2][C:6]([H:14])([H:15])[H:16])([N:3]([C:7]([H:17])([H:18])[H:19])[C:8]([H:20])([H:21])[H:22])([N:4]([C:9]([H:23])([H:24])[H:25])[C:10]([H:26])([H:27])[H:28])[N:5]([C:11]([H:29])([H:30])[H:31])[C:12]([H:32])([H:33])[H:34]
    [H:11][C:4]([H:12])([H:13])[S:7]([C:5]([H:14])([H:15])[H:16])([C:6]([H:17])([H:18])[C:3]([H:9])([H:10])[O:2][H:8])[I:1]
    [P:1]#[C:2][c:8]1[c:6]([H:12])[c:4]([H:10])[c:3]([H:9])[c:5]([H:11])[c:7]1[H:13]
2025-09-11 15:14:48.627 | INFO     | __main__:main:98 - Loading test dataset(s)
2025-09-11 15:14:48.632 | INFO     | __main__:main:103 - Checking test dataset(s)
2025-09-11 15:14:48.700 | WARNING  | __main__:remove_missing_rows:141 - Skipping some SMILES because their topologies do not exist:
    [S:3]([S:4][Br:2])[Br:1]
    [S:3]([S:4][I:2])[I:1]
2025-09-11 15:14:48.710 | INFO     | __main__:main:108 - Training config: {'attributes': {},
 'parameters': {'Angles': {'cols': ['k', 'angle'],
                           'limits': {'angle': [0.0, 3.141592653589793],
                                      'k': [0.0, None]},
                           'scales': {'angle': 1.0, 'k': 0.01}},
                'Bonds': {'cols': ['k', 'length'],
                          'limits': {'k': [0.0, None], 'length': [0.0, None]},
                          'scales': {'k': 0.01, 'length': 1.0}},
                'ProperTorsions': {'cols': ['k'],
                                   'limits': {'k': [0.0, None]},
                                   'scales': {'k': 0.01}}}}
2025-09-11 15:14:48.719 | INFO     | __main__:train_force_field:200 - Training on cpu
2025-09-11 15:14:48.719 | INFO     | __main__:train_force_field:202 - Start training...
2025-09-11 15:14:48.720 | INFO     | __main__:train_force_field:211 - Beginning first epoch
2025-09-11 15:27:47.244 | INFO     | __main__:main:79 - ---------------------- starting script ----------------------
2025-09-11 15:27:47.247 | INFO     | __main__:main:81 - Loading tensor force field
2025-09-11 15:27:53.042 | INFO     | __main__:main:84 - Loading tensor topologies
2025-09-11 15:28:12.942 | INFO     | __main__:main:90 - Loading training dataset(s)
2025-09-11 15:28:13.007 | INFO     | __main__:main:95 - Checking training dataset(s)
2025-09-11 15:28:14.294 | WARNING  | __main__:remove_missing_rows:141 - Skipping some SMILES because their topologies do not exist:
    [F:1][P:4]([F:2])[I:3]
    [N:1]#[C:3][S:4][I:2]
    [I:1][P:21]([I:2])([c:18]1[c:12]([H:31])[c:6]([H:25])[c:3]([H:22])[c:7]([H:26])[c:13]1[H:32])([c:19]1[c:14]([H:33])[c:8]([H:27])[c:4]([H:23])[c:9]([H:28])[c:15]1[H:34])[c:20]1[c:16]([H:35])[c:10]([H:29])[c:5]([H:24])[c:11]([H:30])[c:17]1[H:36]
    [Br:1][S:4][c:16]1[c:13]([H:25])[c:9]([H:21])[c:8]([H:20])[c:12]([H:24])[c:15]1/[N:3]=[N:2]/[c:14]1[c:10]([H:22])[c:6]([H:18])[c:5]([H:17])[c:7]([H:19])[c:11]1[H:23]
    [I:1][P:13]([S:2][C:6]([H:14])([H:15])[H:16])([N:3]([C:7]([H:17])([H:18])[H:19])[C:8]([H:20])([H:21])[H:22])([N:4]([C:9]([H:23])([H:24])[H:25])[C:10]([H:26])([H:27])[H:28])[N:5]([C:11]([H:29])([H:30])[H:31])[C:12]([H:32])([H:33])[H:34]
    [H:11][C:4]([H:12])([H:13])[S:7]([C:5]([H:14])([H:15])[H:16])([C:6]([H:17])([H:18])[C:3]([H:9])([H:10])[O:2][H:8])[I:1]
    [P:1]#[C:2][c:8]1[c:6]([H:12])[c:4]([H:10])[c:3]([H:9])[c:5]([H:11])[c:7]1[H:13]
2025-09-11 15:28:14.314 | INFO     | __main__:main:98 - Loading test dataset(s)
2025-09-11 15:28:14.319 | INFO     | __main__:main:103 - Checking test dataset(s)
2025-09-11 15:28:14.386 | WARNING  | __main__:remove_missing_rows:141 - Skipping some SMILES because their topologies do not exist:
    [S:3]([S:4][Br:2])[Br:1]
    [S:3]([S:4][I:2])[I:1]
2025-09-11 15:28:14.396 | INFO     | __main__:main:108 - Training config: {'attributes': {},
 'parameters': {'Angles': {'cols': ['k', 'angle'],
                           'limits': {'angle': [0.0, 3.141592653589793],
                                      'k': [0.0, None]},
                           'scales': {'angle': 1.0, 'k': 0.01}},
                'Bonds': {'cols': ['k', 'length'],
                          'limits': {'k': [0.0, None], 'length': [0.0, None]},
                          'scales': {'k': 0.01, 'length': 1.0}},
                'ProperTorsions': {'cols': ['k'],
                                   'limits': {'k': [0.0, None]},
                                   'scales': {'k': 0.01}}}}
2025-09-11 15:28:14.405 | INFO     | __main__:train_force_field:200 - Training on cpu
2025-09-11 15:28:14.405 | INFO     | __main__:train_force_field:202 - Start training...
2025-09-11 15:28:14.406 | INFO     | __main__:train_force_field:211 - Beginning first epoch
2025-09-11 15:30:18.180 | INFO     | __main__:main:79 - ---------------------- starting script ----------------------
2025-09-11 15:30:18.180 | INFO     | __main__:main:81 - Loading tensor force field
2025-09-11 15:30:23.782 | INFO     | __main__:main:84 - Loading tensor topologies
2025-09-11 15:30:43.343 | INFO     | __main__:main:90 - Loading training dataset(s)
2025-09-11 15:30:43.393 | INFO     | __main__:main:95 - Checking training dataset(s)
2025-09-11 15:30:44.578 | WARNING  | __main__:remove_missing_rows:141 - Skipping some SMILES because their topologies do not exist:
    [F:1][P:4]([F:2])[I:3]
    [N:1]#[C:3][S:4][I:2]
    [I:1][P:21]([I:2])([c:18]1[c:12]([H:31])[c:6]([H:25])[c:3]([H:22])[c:7]([H:26])[c:13]1[H:32])([c:19]1[c:14]([H:33])[c:8]([H:27])[c:4]([H:23])[c:9]([H:28])[c:15]1[H:34])[c:20]1[c:16]([H:35])[c:10]([H:29])[c:5]([H:24])[c:11]([H:30])[c:17]1[H:36]
    [Br:1][S:4][c:16]1[c:13]([H:25])[c:9]([H:21])[c:8]([H:20])[c:12]([H:24])[c:15]1/[N:3]=[N:2]/[c:14]1[c:10]([H:22])[c:6]([H:18])[c:5]([H:17])[c:7]([H:19])[c:11]1[H:23]
    [I:1][P:13]([S:2][C:6]([H:14])([H:15])[H:16])([N:3]([C:7]([H:17])([H:18])[H:19])[C:8]([H:20])([H:21])[H:22])([N:4]([C:9]([H:23])([H:24])[H:25])[C:10]([H:26])([H:27])[H:28])[N:5]([C:11]([H:29])([H:30])[H:31])[C:12]([H:32])([H:33])[H:34]
    [H:11][C:4]([H:12])([H:13])[S:7]([C:5]([H:14])([H:15])[H:16])([C:6]([H:17])([H:18])[C:3]([H:9])([H:10])[O:2][H:8])[I:1]
    [P:1]#[C:2][c:8]1[c:6]([H:12])[c:4]([H:10])[c:3]([H:9])[c:5]([H:11])[c:7]1[H:13]
2025-09-11 15:30:44.598 | INFO     | __main__:main:98 - Loading test dataset(s)
2025-09-11 15:30:44.602 | INFO     | __main__:main:103 - Checking test dataset(s)
2025-09-11 15:30:44.669 | WARNING  | __main__:remove_missing_rows:141 - Skipping some SMILES because their topologies do not exist:
    [S:3]([S:4][Br:2])[Br:1]
    [S:3]([S:4][I:2])[I:1]
2025-09-11 15:30:44.679 | INFO     | __main__:main:108 - Training config: {'attributes': {},
 'parameters': {'Angles': {'cols': ['k', 'angle'],
                           'limits': {'angle': [0.0, 3.141592653589793],
                                      'k': [0.0, None]},
                           'scales': {'angle': 1.0, 'k': 0.01}},
                'Bonds': {'cols': ['k', 'length'],
                          'limits': {'k': [0.0, None], 'length': [0.0, None]},
                          'scales': {'k': 0.01, 'length': 1.0}},
                'ProperTorsions': {'cols': ['k'],
                                   'limits': {'k': [0.0, None]},
                                   'scales': {'k': 0.01}}}}
2025-09-11 15:30:44.687 | INFO     | __main__:train_force_field:200 - Training on cpu
2025-09-11 15:30:44.688 | INFO     | __main__:train_force_field:202 - Start training...
2025-09-11 15:30:44.688 | INFO     | __main__:train_force_field:211 - Beginning first epoch
2025-09-11 15:32:54.196 | INFO     | __main__:main:79 - ---------------------- starting script ----------------------
2025-09-11 15:32:54.196 | INFO     | __main__:main:81 - Loading tensor force field
2025-09-12 11:37:35.794 | INFO     | __main__:main:79 - ---------------------- starting script ----------------------
2025-09-12 11:37:35.794 | INFO     | __main__:main:81 - Loading tensor force field
2025-09-12 11:37:43.397 | INFO     | __main__:main:84 - Loading tensor topologies
2025-09-12 11:38:33.763 | INFO     | __main__:main:90 - Loading training dataset(s)
2025-09-12 11:38:33.973 | INFO     | __main__:main:95 - Checking training dataset(s)
2025-09-12 11:38:35.220 | WARNING  | __main__:remove_missing_rows:142 - Skipping some SMILES because their topologies do not exist:
    [F:1][P:4]([F:2])[I:3]
    [N:1]#[C:3][S:4][I:2]
    [I:1][P:21]([I:2])([c:18]1[c:12]([H:31])[c:6]([H:25])[c:3]([H:22])[c:7]([H:26])[c:13]1[H:32])([c:19]1[c:14]([H:33])[c:8]([H:27])[c:4]([H:23])[c:9]([H:28])[c:15]1[H:34])[c:20]1[c:16]([H:35])[c:10]([H:29])[c:5]([H:24])[c:11]([H:30])[c:17]1[H:36]
    [Br:1][S:4][c:16]1[c:13]([H:25])[c:9]([H:21])[c:8]([H:20])[c:12]([H:24])[c:15]1/[N:3]=[N:2]/[c:14]1[c:10]([H:22])[c:6]([H:18])[c:5]([H:17])[c:7]([H:19])[c:11]1[H:23]
    [I:1][P:13]([S:2][C:6]([H:14])([H:15])[H:16])([N:3]([C:7]([H:17])([H:18])[H:19])[C:8]([H:20])([H:21])[H:22])([N:4]([C:9]([H:23])([H:24])[H:25])[C:10]([H:26])([H:27])[H:28])[N:5]([C:11]([H:29])([H:30])[H:31])[C:12]([H:32])([H:33])[H:34]
    [H:11][C:4]([H:12])([H:13])[S:7]([C:5]([H:14])([H:15])[H:16])([C:6]([H:17])([H:18])[C:3]([H:9])([H:10])[O:2][H:8])[I:1]
    [P:1]#[C:2][c:8]1[c:6]([H:12])[c:4]([H:10])[c:3]([H:9])[c:5]([H:11])[c:7]1[H:13]
2025-09-12 11:38:35.241 | INFO     | __main__:main:98 - Loading test dataset(s)
2025-09-12 11:38:35.247 | INFO     | __main__:main:103 - Checking test dataset(s)
2025-09-12 11:38:35.318 | WARNING  | __main__:remove_missing_rows:142 - Skipping some SMILES because their topologies do not exist:
    [S:3]([S:4][Br:2])[Br:1]
    [S:3]([S:4][I:2])[I:1]
2025-09-12 11:38:35.329 | INFO     | __main__:main:108 - Training config: {'attributes': {},
 'parameters': {'Angles': {'cols': ['k', 'angle'],
                           'limits': {'angle': [0.0, 3.141592653589793],
                                      'k': [0.0, None]},
                           'scales': {'angle': 1.0, 'k': 0.01}},
                'Bonds': {'cols': ['k', 'length'],
                          'limits': {'k': [0.0, None], 'length': [0.0, None]},
                          'scales': {'k': 0.01, 'length': 1.0}},
                'ProperTorsions': {'cols': ['k'],
                                   'limits': {'k': [0.0, None]},
                                   'scales': {'k': 0.01}}}}
2025-09-12 11:38:35.339 | INFO     | __main__:train_force_field:201 - Training on cpu
2025-09-12 11:38:35.339 | INFO     | __main__:train_force_field:203 - Start training...
2025-09-12 11:38:35.340 | INFO     | __main__:train_force_field:212 - Beginning first epoch
2025-09-12 11:44:09.967 | INFO     | __main__:main:79 - ---------------------- starting script ----------------------
2025-09-12 11:44:09.967 | INFO     | __main__:main:81 - Loading tensor force field
2025-09-12 11:44:15.184 | INFO     | __main__:main:84 - Loading tensor topologies
2025-09-12 11:44:39.967 | INFO     | __main__:main:90 - Loading training dataset(s)
2025-09-12 11:44:40.013 | INFO     | __main__:main:95 - Checking training dataset(s)
2025-09-12 11:44:41.286 | WARNING  | __main__:remove_missing_rows:142 - Skipping some SMILES because their topologies do not exist:
    [F:1][P:4]([F:2])[I:3]
    [N:1]#[C:3][S:4][I:2]
    [I:1][P:21]([I:2])([c:18]1[c:12]([H:31])[c:6]([H:25])[c:3]([H:22])[c:7]([H:26])[c:13]1[H:32])([c:19]1[c:14]([H:33])[c:8]([H:27])[c:4]([H:23])[c:9]([H:28])[c:15]1[H:34])[c:20]1[c:16]([H:35])[c:10]([H:29])[c:5]([H:24])[c:11]([H:30])[c:17]1[H:36]
    [Br:1][S:4][c:16]1[c:13]([H:25])[c:9]([H:21])[c:8]([H:20])[c:12]([H:24])[c:15]1/[N:3]=[N:2]/[c:14]1[c:10]([H:22])[c:6]([H:18])[c:5]([H:17])[c:7]([H:19])[c:11]1[H:23]
    [I:1][P:13]([S:2][C:6]([H:14])([H:15])[H:16])([N:3]([C:7]([H:17])([H:18])[H:19])[C:8]([H:20])([H:21])[H:22])([N:4]([C:9]([H:23])([H:24])[H:25])[C:10]([H:26])([H:27])[H:28])[N:5]([C:11]([H:29])([H:30])[H:31])[C:12]([H:32])([H:33])[H:34]
    [H:11][C:4]([H:12])([H:13])[S:7]([C:5]([H:14])([H:15])[H:16])([C:6]([H:17])([H:18])[C:3]([H:9])([H:10])[O:2][H:8])[I:1]
    [P:1]#[C:2][c:8]1[c:6]([H:12])[c:4]([H:10])[c:3]([H:9])[c:5]([H:11])[c:7]1[H:13]
2025-09-12 11:44:41.308 | INFO     | __main__:main:98 - Loading test dataset(s)
2025-09-12 11:44:41.312 | INFO     | __main__:main:103 - Checking test dataset(s)
2025-09-12 11:44:41.379 | WARNING  | __main__:remove_missing_rows:142 - Skipping some SMILES because their topologies do not exist:
    [S:3]([S:4][Br:2])[Br:1]
    [S:3]([S:4][I:2])[I:1]
2025-09-12 11:44:41.388 | INFO     | __main__:main:108 - Training config: {'attributes': {},
 'parameters': {'Angles': {'cols': ['k', 'angle'],
                           'limits': {'angle': [0.0, 3.141592653589793],
                                      'k': [0.0, None]},
                           'scales': {'angle': 1.0, 'k': 0.01}},
                'Bonds': {'cols': ['k', 'length'],
                          'limits': {'k': [0.0, None], 'length': [0.0, None]},
                          'scales': {'k': 0.01, 'length': 1.0}},
                'ProperTorsions': {'cols': ['k'],
                                   'limits': {'k': [0.0, None]},
                                   'scales': {'k': 0.01}}}}
2025-09-12 11:44:41.397 | INFO     | __main__:train_force_field:199 - torch.cuda.is_available()=True
2025-09-12 11:44:41.397 | INFO     | __main__:train_force_field:204 - Training on cuda
2025-09-12 11:44:41.604 | INFO     | __main__:train_force_field:208 - Start training...
2025-09-12 11:44:41.606 | ERROR    | __main__:<module>:305 - An error has been caught in function '<module>', process 'MainProcess' (30681), thread 'MainThread' (140250469959296):
Traceback (most recent call last):

> File "/home/joshmitchell/Documents/openff/back-to-school-josh/workflow/05-fit/fit.py", line 306, in <module>
    app()
    └ App(name=('fit',), help='\nTODO: Write me!\n\n**Input files:**\n\nFile 1\n    File 1 description\n\nFile 2\n    File 2 descri...

  File "/home/joshmitchell/Documents/openff/back-to-school-josh/.rocm-env/lib/python3.11/site-packages/cyclopts/core.py", line 1393, in __call__
    return _run_maybe_async_command(command, bound, backend)
           │                        │        │      └ 'asyncio'
           │                        │        └ <BoundArguments (tensor_ff_path=PosixPath('../04-parametrize/outputs/tensor_ff.pt'), tensor_tops_path=PosixPath('../04-parame...
           │                        └ <function main at 0x7f8e9ad62660>
           └ <function _run_maybe_async_command at 0x7f8bc3b82340>
  File "/home/joshmitchell/Documents/openff/back-to-school-josh/.rocm-env/lib/python3.11/site-packages/cyclopts/core.py", line 186, in _run_maybe_async_command
    return command(*bound.args, **bound.kwargs)
           │        │     │       │     └ <property object at 0x7f8e9ad36c00>
           │        │     │       └ <BoundArguments (tensor_ff_path=PosixPath('../04-parametrize/outputs/tensor_ff.pt'), tensor_tops_path=PosixPath('../04-parame...
           │        │     └ <property object at 0x7f8e9ad36bb0>
           │        └ <BoundArguments (tensor_ff_path=PosixPath('../04-parametrize/outputs/tensor_ff.pt'), tensor_tops_path=PosixPath('../04-parame...
           └ <function main at 0x7f8e9ad62660>

  File "/home/joshmitchell/Documents/openff/back-to-school-josh/workflow/05-fit/fit.py", line 122, in main
    train_force_field(
    └ <function train_force_field at 0x7f8bc3fd16c0>

  File "/home/joshmitchell/Documents/openff/back-to-school-josh/workflow/05-fit/fit.py", line 210, in train_force_field
    optimizer = torch.optim.Adam(
                │     │     └ <class 'torch.optim.adam.Adam'>
                │     └ <module 'torch.optim' from '/home/joshmitchell/Documents/openff/back-to-school-josh/.rocm-env/lib/python3.11/site-packages/to...
                └ <module 'torch' from '/home/joshmitchell/Documents/openff/back-to-school-josh/.rocm-env/lib/python3.11/site-packages/torch/__...

  File "/home/joshmitchell/Documents/openff/back-to-school-josh/.rocm-env/lib/python3.11/site-packages/torch/optim/adam.py", line 99, in __init__
    super().__init__(params, defaults)
                     │       └ {'lr': 0.001, 'betas': (0.9, 0.999), 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': True, 'maximize': False, 'foreach': None, 'c...
                     └ [tensor([2.7517, 1.7158, 1.3302,  ..., 0.0000, 0.0000, 0.0000], device='cuda:0',
                              dtype=torch.float64, grad_fn=<ToCopyB...
  File "/home/joshmitchell/Documents/openff/back-to-school-josh/.rocm-env/lib/python3.11/site-packages/torch/optim/optimizer.py", line 377, in __init__
    self.add_param_group(cast(dict, param_group))
    │    │               │          └ {'params': [tensor([2.7517, 1.7158, 1.3302,  ..., 0.0000, 0.0000, 0.0000], device='cuda:0',
    │    │               │                   dtype=torch.float64, grad_...
    │    │               └ <function cast at 0x7f8e9ada5760>
    │    └ <function Optimizer.add_param_group at 0x7f8c221b3f60>
    └ Adam ()
  File "/home/joshmitchell/Documents/openff/back-to-school-josh/.rocm-env/lib/python3.11/site-packages/torch/_compile.py", line 32, in inner
    return disable_fn(*args, **kwargs)
           │           │       └ {}
           │           └ (Adam (), {'params': [tensor([2.7517, 1.7158, 1.3302,  ..., 0.0000, 0.0000, 0.0000], device='cuda:0',
           │                    dtype=torch.floa...
           └ <function Optimizer.add_param_group at 0x7f8bc05aac00>
  File "/home/joshmitchell/Documents/openff/back-to-school-josh/.rocm-env/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 745, in _fn
    return fn(*args, **kwargs)
           │   │       └ {}
           │   └ (Adam (), {'params': [tensor([2.7517, 1.7158, 1.3302,  ..., 0.0000, 0.0000, 0.0000], device='cuda:0',
           │            dtype=torch.floa...
           └ <function Optimizer.add_param_group at 0x7f8c221b3ec0>
  File "/home/joshmitchell/Documents/openff/back-to-school-josh/.rocm-env/lib/python3.11/site-packages/torch/optim/optimizer.py", line 1064, in add_param_group
    raise ValueError("can't optimize a non-leaf Tensor")

ValueError: can't optimize a non-leaf Tensor
2025-09-12 11:57:48.999 | INFO     | __main__:main:79 - ---------------------- starting script ----------------------
2025-09-12 11:57:48.999 | INFO     | __main__:main:81 - Loading tensor force field
2025-09-12 11:57:54.213 | INFO     | __main__:main:84 - Loading tensor topologies
2025-09-12 11:58:18.861 | INFO     | __main__:main:90 - Loading training dataset(s)
2025-09-12 11:58:18.911 | INFO     | __main__:main:95 - Checking training dataset(s)
2025-09-12 11:58:20.130 | WARNING  | __main__:remove_missing_rows:138 - Skipping some SMILES because their topologies do not exist:
    [F:1][P:4]([F:2])[I:3]
    [N:1]#[C:3][S:4][I:2]
    [I:1][P:21]([I:2])([c:18]1[c:12]([H:31])[c:6]([H:25])[c:3]([H:22])[c:7]([H:26])[c:13]1[H:32])([c:19]1[c:14]([H:33])[c:8]([H:27])[c:4]([H:23])[c:9]([H:28])[c:15]1[H:34])[c:20]1[c:16]([H:35])[c:10]([H:29])[c:5]([H:24])[c:11]([H:30])[c:17]1[H:36]
    [Br:1][S:4][c:16]1[c:13]([H:25])[c:9]([H:21])[c:8]([H:20])[c:12]([H:24])[c:15]1/[N:3]=[N:2]/[c:14]1[c:10]([H:22])[c:6]([H:18])[c:5]([H:17])[c:7]([H:19])[c:11]1[H:23]
    [I:1][P:13]([S:2][C:6]([H:14])([H:15])[H:16])([N:3]([C:7]([H:17])([H:18])[H:19])[C:8]([H:20])([H:21])[H:22])([N:4]([C:9]([H:23])([H:24])[H:25])[C:10]([H:26])([H:27])[H:28])[N:5]([C:11]([H:29])([H:30])[H:31])[C:12]([H:32])([H:33])[H:34]
    [H:11][C:4]([H:12])([H:13])[S:7]([C:5]([H:14])([H:15])[H:16])([C:6]([H:17])([H:18])[C:3]([H:9])([H:10])[O:2][H:8])[I:1]
    [P:1]#[C:2][c:8]1[c:6]([H:12])[c:4]([H:10])[c:3]([H:9])[c:5]([H:11])[c:7]1[H:13]
2025-09-12 11:58:20.151 | INFO     | __main__:main:98 - Loading test dataset(s)
2025-09-12 11:58:20.156 | INFO     | __main__:main:103 - Checking test dataset(s)
2025-09-12 11:58:20.222 | WARNING  | __main__:remove_missing_rows:138 - Skipping some SMILES because their topologies do not exist:
    [S:3]([S:4][Br:2])[Br:1]
    [S:3]([S:4][I:2])[I:1]
2025-09-12 11:58:20.232 | INFO     | __main__:main:108 - Training config: {'attributes': {},
 'parameters': {'Angles': {'cols': ['k', 'angle'],
                           'limits': {'angle': [0.0, 3.141592653589793],
                                      'k': [0.0, None]},
                           'scales': {'angle': 1.0, 'k': 0.01}},
                'Bonds': {'cols': ['k', 'length'],
                          'limits': {'k': [0.0, None], 'length': [0.0, None]},
                          'scales': {'k': 0.01, 'length': 1.0}},
                'ProperTorsions': {'cols': ['k'],
                                   'limits': {'k': [0.0, None]},
                                   'scales': {'k': 0.01}}}}
2025-09-12 11:58:20.232 | INFO     | __main__:train_force_field:197 - torch.cuda.is_available()=True
2025-09-12 11:58:20.232 | INFO     | __main__:train_force_field:202 - Training on cuda
2025-09-12 11:58:28.962 | INFO     | __main__:train_force_field:217 - Start training...
2025-09-12 11:58:28.963 | INFO     | __main__:train_force_field:226 - Beginning first epoch
2025-09-12 11:58:29.038 | ERROR    | __main__:<module>:314 - An error has been caught in function '<module>', process 'MainProcess' (31578), thread 'MainThread' (139877051647616):
Traceback (most recent call last):

> File "/home/joshmitchell/Documents/openff/back-to-school-josh/workflow/05-fit/fit.py", line 315, in <module>
    app()
    └ App(name=('fit',), help='\nTODO: Write me!\n\n**Input files:**\n\nFile 1\n    File 1 description\n\nFile 2\n    File 2 descri...

  File "/home/joshmitchell/Documents/openff/back-to-school-josh/.rocm-env/lib/python3.11/site-packages/cyclopts/core.py", line 1393, in __call__
    return _run_maybe_async_command(command, bound, backend)
           │                        │        │      └ 'asyncio'
           │                        │        └ <BoundArguments (tensor_ff_path=PosixPath('../04-parametrize/outputs/tensor_ff.pt'), tensor_tops_path=PosixPath('../04-parame...
           │                        └ <function main at 0x7f37a9ed8680>
           └ <function _run_maybe_async_command at 0x7f34d238a2a0>
  File "/home/joshmitchell/Documents/openff/back-to-school-josh/.rocm-env/lib/python3.11/site-packages/cyclopts/core.py", line 186, in _run_maybe_async_command
    return command(*bound.args, **bound.kwargs)
           │        │     │       │     └ <property object at 0x7f37a95e6bb0>
           │        │     │       └ <BoundArguments (tensor_ff_path=PosixPath('../04-parametrize/outputs/tensor_ff.pt'), tensor_tops_path=PosixPath('../04-parame...
           │        │     └ <property object at 0x7f37a95e6b60>
           │        └ <BoundArguments (tensor_ff_path=PosixPath('../04-parametrize/outputs/tensor_ff.pt'), tensor_tops_path=PosixPath('../04-parame...
           └ <function main at 0x7f37a9ed8680>

  File "/home/joshmitchell/Documents/openff/back-to-school-josh/workflow/05-fit/fit.py", line 110, in main
    train_force_field(
    └ <function train_force_field at 0x7f34d27d9620>

  File "/home/joshmitchell/Documents/openff/back-to-school-josh/workflow/05-fit/fit.py", line 240, in train_force_field
    e_ref, e_pred, f_ref, f_pred = descent.targets.energy.predict(
                                   │       │       │      └ <function predict at 0x7f377c755940>
                                   │       │       └ <module 'descent.targets.energy' from '/home/joshmitchell/Documents/openff/back-to-school-josh/.rocm-env/lib/python3.11/site-...
                                   │       └ <module 'descent.targets' from '/home/joshmitchell/Documents/openff/back-to-school-josh/.rocm-env/lib/python3.11/site-package...
                                   └ <module 'descent' from '/home/joshmitchell/Documents/openff/back-to-school-josh/.rocm-env/lib/python3.11/site-packages/descen...

  File "/home/joshmitchell/Documents/openff/back-to-school-josh/.rocm-env/lib/python3.11/site-packages/descent/targets/energy.py", line 121, in predict
    energy_pred = smee.compute_energy(topology, force_field, coords)
                  │    │              │         │            └ tensor([[[-9.7179e-01,  1.8268e+00,  1.5363e-01],
                  │    │              │         │                       [ 9.1550e-02, -1.2286e+00,  9.0972e-02],
                  │    │              │         │                       [-2.1145e-01,  4...
                  │    │              │         └ TensorForceField(potentials=[TensorPotential(type='Angles', fn='k/2*(theta-angle)**2', parameters=tensor([[275.1660,   1.7158...
                  │    │              └ TensorTopology(atomic_nums=tensor([17, 16, 16,  1]), formal_charges=tensor([0, 0, 0, 0]), bond_idxs=tensor([[0, 2],
                  │    │                        [...
                  │    └ <function compute_energy at 0x7f34d2a3f560>
                  └ <module 'smee' from '/home/joshmitchell/Documents/openff/back-to-school-josh/.rocm-env/lib/python3.11/site-packages/smee/__in...
  File "/home/joshmitchell/Documents/openff/back-to-school-josh/.rocm-env/lib/python3.11/site-packages/smee/potentials/_potentials.py", line 364, in compute_energy
    energy += compute_energy_potential(
    │         └ <function compute_energy_potential at 0x7f34d2a3f420>
    └ tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
              0., 0., 0., 0...
  File "/home/joshmitchell/Documents/openff/back-to-school-josh/.rocm-env/lib/python3.11/site-packages/smee/potentials/_potentials.py", line 328, in compute_energy_potential
    return energy_fn(system, potential, conformer, **energy_fn_kwargs)
           │         │       │          │            └ {}
           │         │       │          └ tensor([[[-9.7179e-01,  1.8268e+00,  1.5363e-01],
           │         │       │                     [ 9.1550e-02, -1.2286e+00,  9.0972e-02],
           │         │       │                     [-2.1145e-01,  4...
           │         │       └ TensorPotential(type='Angles', fn='k/2*(theta-angle)**2', parameters=tensor([[275.1660,   1.7158],
           │         │                 [133.0182,   1.918...
           │         └ TensorSystem(topologies=[TensorTopology(atomic_nums=tensor([17, 16, 16,  1]), formal_charges=tensor([0, 0, 0, 0]), bond_idxs=...
           └ <function compute_harmonic_angle_energy at 0x7f34cbdf4b80>
  File "/home/joshmitchell/Documents/openff/back-to-school-josh/.rocm-env/lib/python3.11/site-packages/smee/potentials/valence.py", line 66, in compute_harmonic_angle_energy
    theta = smee.geometry.compute_angles(conformer, particle_idxs)
            │    │        │              │          └ tensor([[0, 2, 1],
            │    │        │              │                    [2, 1, 3]], device='cuda:0')
            │    │        │              └ tensor([[[-9.7179e-01,  1.8268e+00,  1.5363e-01],
            │    │        │                         [ 9.1550e-02, -1.2286e+00,  9.0972e-02],
            │    │        │                         [-2.1145e-01,  4...
            │    │        └ <function compute_angles at 0x7f352c831a80>
            │    └ <module 'smee.geometry' from '/home/joshmitchell/Documents/openff/back-to-school-josh/.rocm-env/lib/python3.11/site-packages/...
            └ <module 'smee' from '/home/joshmitchell/Documents/openff/back-to-school-josh/.rocm-env/lib/python3.11/site-packages/smee/__in...
  File "/home/joshmitchell/Documents/openff/back-to-school-josh/.rocm-env/lib/python3.11/site-packages/smee/geometry.py", line 93, in compute_angles
    vector_ab = conformer[:, atom_indices[:, 1]] - conformer[:, atom_indices[:, 0]]
                │            │                     │            └ tensor([[0, 2, 1],
                │            │                     │                      [2, 1, 3]], device='cuda:0')
                │            │                     └ tensor([[[-9.7179e-01,  1.8268e+00,  1.5363e-01],
                │            │                                [ 9.1550e-02, -1.2286e+00,  9.0972e-02],
                │            │                                [-2.1145e-01,  4...
                │            └ tensor([[0, 2, 1],
                │                      [2, 1, 3]], device='cuda:0')
                └ tensor([[[-9.7179e-01,  1.8268e+00,  1.5363e-01],
                           [ 9.1550e-02, -1.2286e+00,  9.0972e-02],
                           [-2.1145e-01,  4...

RuntimeError: indices should be either on cpu or on the same device as the indexed tensor (cpu)
2025-09-12 12:17:08.835 | INFO     | __main__:main:81 - ---------------------- starting script ----------------------
2025-09-12 12:17:08.835 | INFO     | __main__:main:83 - Loading tensor force field
2025-09-12 12:17:14.034 | INFO     | __main__:main:86 - Loading tensor topologies
2025-09-12 12:17:39.655 | INFO     | __main__:main:92 - Loading training dataset(s)
2025-09-12 12:17:39.705 | INFO     | __main__:main:97 - Checking training dataset(s)
2025-09-12 12:17:40.959 | WARNING  | __main__:remove_missing_rows:140 - Skipping some SMILES because their topologies do not exist:
    [F:1][P:4]([F:2])[I:3]
    [N:1]#[C:3][S:4][I:2]
    [I:1][P:21]([I:2])([c:18]1[c:12]([H:31])[c:6]([H:25])[c:3]([H:22])[c:7]([H:26])[c:13]1[H:32])([c:19]1[c:14]([H:33])[c:8]([H:27])[c:4]([H:23])[c:9]([H:28])[c:15]1[H:34])[c:20]1[c:16]([H:35])[c:10]([H:29])[c:5]([H:24])[c:11]([H:30])[c:17]1[H:36]
    [Br:1][S:4][c:16]1[c:13]([H:25])[c:9]([H:21])[c:8]([H:20])[c:12]([H:24])[c:15]1/[N:3]=[N:2]/[c:14]1[c:10]([H:22])[c:6]([H:18])[c:5]([H:17])[c:7]([H:19])[c:11]1[H:23]
    [I:1][P:13]([S:2][C:6]([H:14])([H:15])[H:16])([N:3]([C:7]([H:17])([H:18])[H:19])[C:8]([H:20])([H:21])[H:22])([N:4]([C:9]([H:23])([H:24])[H:25])[C:10]([H:26])([H:27])[H:28])[N:5]([C:11]([H:29])([H:30])[H:31])[C:12]([H:32])([H:33])[H:34]
    [H:11][C:4]([H:12])([H:13])[S:7]([C:5]([H:14])([H:15])[H:16])([C:6]([H:17])([H:18])[C:3]([H:9])([H:10])[O:2][H:8])[I:1]
    [P:1]#[C:2][c:8]1[c:6]([H:12])[c:4]([H:10])[c:3]([H:9])[c:5]([H:11])[c:7]1[H:13]
2025-09-12 12:17:40.980 | INFO     | __main__:main:100 - Loading test dataset(s)
2025-09-12 12:17:40.984 | INFO     | __main__:main:105 - Checking test dataset(s)
2025-09-12 12:17:41.057 | WARNING  | __main__:remove_missing_rows:140 - Skipping some SMILES because their topologies do not exist:
    [S:3]([S:4][Br:2])[Br:1]
    [S:3]([S:4][I:2])[I:1]
2025-09-12 12:17:41.068 | INFO     | __main__:main:110 - Training config: {'attributes': {},
 'parameters': {'Angles': {'cols': ['k', 'angle'],
                           'limits': {'angle': [0.0, 3.141592653589793],
                                      'k': [0.0, None]},
                           'scales': {'angle': 1.0, 'k': 0.01}},
                'Bonds': {'cols': ['k', 'length'],
                          'limits': {'k': [0.0, None], 'length': [0.0, None]},
                          'scales': {'k': 0.01, 'length': 1.0}},
                'ProperTorsions': {'cols': ['k'],
                                   'limits': {'k': [0.0, None]},
                                   'scales': {'k': 0.01}}}}
2025-09-12 12:17:41.068 | INFO     | __main__:train_force_field:199 - torch.cuda.is_available()=True
2025-09-12 12:17:41.068 | INFO     | __main__:train_force_field:204 - Training on cuda
2025-09-12 12:17:49.888 | INFO     | __main__:train_force_field:219 - Start training...
2025-09-12 12:17:49.889 | INFO     | __main__:train_force_field:228 - Beginning first epoch
2025-09-12 12:18:56.346 | ERROR    | __main__:<module>:326 - An error has been caught in function '<module>', process 'MainProcess' (35224), thread 'MainThread' (139694125811328):
Traceback (most recent call last):

> File "/home/joshmitchell/Documents/openff/back-to-school-josh/workflow/05-fit/fit.py", line 327, in <module>
    app()
    └ App(name=('fit',), help='\nTODO: Write me!\n\n**Input files:**\n\nFile 1\n    File 1 description\n\nFile 2\n    File 2 descri...

  File "/home/joshmitchell/Documents/openff/back-to-school-josh/.rocm-env/lib/python3.11/site-packages/cyclopts/core.py", line 1393, in __call__
    return _run_maybe_async_command(command, bound, backend)
           │                        │        │      └ 'asyncio'
           │                        │        └ <BoundArguments (tensor_ff_path=PosixPath('../04-parametrize/outputs/tensor_ff.pt'), tensor_tops_path=PosixPath('../04-parame...
           │                        └ <function main at 0x7f0d12b2c680>
           └ <function _run_maybe_async_command at 0x7f0a3b3b53a0>
  File "/home/joshmitchell/Documents/openff/back-to-school-josh/.rocm-env/lib/python3.11/site-packages/cyclopts/core.py", line 186, in _run_maybe_async_command
    return command(*bound.args, **bound.kwargs)
           │        │     │       │     └ <property object at 0x7f0d1223acf0>
           │        │     │       └ <BoundArguments (tensor_ff_path=PosixPath('../04-parametrize/outputs/tensor_ff.pt'), tensor_tops_path=PosixPath('../04-parame...
           │        │     └ <property object at 0x7f0d1223aca0>
           │        └ <BoundArguments (tensor_ff_path=PosixPath('../04-parametrize/outputs/tensor_ff.pt'), tensor_tops_path=PosixPath('../04-parame...
           └ <function main at 0x7f0d12b2c680>

  File "/home/joshmitchell/Documents/openff/back-to-school-josh/workflow/05-fit/fit.py", line 112, in main
    train_force_field(
    └ <function train_force_field at 0x7f0a3b301620>

  File "/home/joshmitchell/Documents/openff/back-to-school-josh/workflow/05-fit/fit.py", line 244, in train_force_field
    e_ref, e_pred, f_ref, f_pred = descent.targets.energy.predict(
                                   │       │       │      └ <function predict at 0x7f0ce53c5940>
                                   │       │       └ <module 'descent.targets.energy' from '/home/joshmitchell/Documents/openff/back-to-school-josh/.rocm-env/lib/python3.11/site-...
                                   │       └ <module 'descent.targets' from '/home/joshmitchell/Documents/openff/back-to-school-josh/.rocm-env/lib/python3.11/site-package...
                                   └ <module 'descent' from '/home/joshmitchell/Documents/openff/back-to-school-josh/.rocm-env/lib/python3.11/site-packages/descen...

  File "/home/joshmitchell/Documents/openff/back-to-school-josh/.rocm-env/lib/python3.11/site-packages/descent/targets/energy.py", line 121, in predict
    energy_pred = smee.compute_energy(topology, force_field, coords)
                  │    │              │         │            └ tensor([[[-9.7179e-01,  1.8268e+00,  1.5363e-01],
                  │    │              │         │                       [ 9.1550e-02, -1.2286e+00,  9.0972e-02],
                  │    │              │         │                       [-2.1145e-01,  4...
                  │    │              │         └ TensorForceField(potentials=[TensorPotential(type='Angles', fn='k/2*(theta-angle)**2', parameters=tensor([[275.1660,   1.7158...
                  │    │              └ TensorTopology(atomic_nums=tensor([17, 16, 16,  1]), formal_charges=tensor([0, 0, 0, 0]), bond_idxs=tensor([[0, 2],
                  │    │                        [...
                  │    └ <function compute_energy at 0x7f0a4f493560>
                  └ <module 'smee' from '/home/joshmitchell/Documents/openff/back-to-school-josh/.rocm-env/lib/python3.11/site-packages/smee/__in...
  File "/home/joshmitchell/Documents/openff/back-to-school-josh/.rocm-env/lib/python3.11/site-packages/smee/potentials/_potentials.py", line 364, in compute_energy
    energy += compute_energy_potential(
    │         └ <function compute_energy_potential at 0x7f0a4f493420>
    └ tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
              0., 0., 0., 0...
  File "/home/joshmitchell/Documents/openff/back-to-school-josh/.rocm-env/lib/python3.11/site-packages/smee/potentials/_potentials.py", line 328, in compute_energy_potential
    return energy_fn(system, potential, conformer, **energy_fn_kwargs)
           │         │       │          │            └ {}
           │         │       │          └ tensor([[[-9.7179e-01,  1.8268e+00,  1.5363e-01],
           │         │       │                     [ 9.1550e-02, -1.2286e+00,  9.0972e-02],
           │         │       │                     [-2.1145e-01,  4...
           │         │       └ TensorPotential(type='Angles', fn='k/2*(theta-angle)**2', parameters=tensor([[275.1660,   1.7158],
           │         │                 [133.0182,   1.918...
           │         └ TensorSystem(topologies=[TensorTopology(atomic_nums=tensor([17, 16, 16,  1]), formal_charges=tensor([0, 0, 0, 0]), bond_idxs=...
           └ <function compute_harmonic_angle_energy at 0x7f0a21910a40>
  File "/home/joshmitchell/Documents/openff/back-to-school-josh/.rocm-env/lib/python3.11/site-packages/smee/potentials/valence.py", line 66, in compute_harmonic_angle_energy
    theta = smee.geometry.compute_angles(conformer, particle_idxs)
            │    │        │              │          └ tensor([[0, 2, 1],
            │    │        │              │                    [2, 1, 3]], device='cuda:0')
            │    │        │              └ tensor([[[-9.7179e-01,  1.8268e+00,  1.5363e-01],
            │    │        │                         [ 9.1550e-02, -1.2286e+00,  9.0972e-02],
            │    │        │                         [-2.1145e-01,  4...
            │    │        └ <function compute_angles at 0x7f0a9553da80>
            │    └ <module 'smee.geometry' from '/home/joshmitchell/Documents/openff/back-to-school-josh/.rocm-env/lib/python3.11/site-packages/...
            └ <module 'smee' from '/home/joshmitchell/Documents/openff/back-to-school-josh/.rocm-env/lib/python3.11/site-packages/smee/__in...
  File "/home/joshmitchell/Documents/openff/back-to-school-josh/.rocm-env/lib/python3.11/site-packages/smee/geometry.py", line 93, in compute_angles
    vector_ab = conformer[:, atom_indices[:, 1]] - conformer[:, atom_indices[:, 0]]
                │            │                     │            └ tensor([[0, 2, 1],
                │            │                     │                      [2, 1, 3]], device='cuda:0')
                │            │                     └ tensor([[[-9.7179e-01,  1.8268e+00,  1.5363e-01],
                │            │                                [ 9.1550e-02, -1.2286e+00,  9.0972e-02],
                │            │                                [-2.1145e-01,  4...
                │            └ tensor([[0, 2, 1],
                │                      [2, 1, 3]], device='cuda:0')
                └ tensor([[[-9.7179e-01,  1.8268e+00,  1.5363e-01],
                           [ 9.1550e-02, -1.2286e+00,  9.0972e-02],
                           [-2.1145e-01,  4...

RuntimeError: indices should be either on cpu or on the same device as the indexed tensor (cpu)
2025-09-12 12:31:55.377 | INFO     | __main__:main:81 - ---------------------- starting script ----------------------
2025-09-12 12:31:55.377 | INFO     | __main__:main:83 - Loading tensor force field
2025-09-12 12:32:00.618 | INFO     | __main__:main:86 - Loading tensor topologies
2025-09-12 12:32:25.522 | INFO     | __main__:main:92 - Loading training dataset(s)
2025-09-12 12:32:25.569 | INFO     | __main__:main:97 - Checking training dataset(s)
2025-09-12 12:32:26.806 | WARNING  | __main__:remove_missing_rows:140 - Skipping some SMILES because their topologies do not exist:
    [F:1][P:4]([F:2])[I:3]
    [N:1]#[C:3][S:4][I:2]
    [I:1][P:21]([I:2])([c:18]1[c:12]([H:31])[c:6]([H:25])[c:3]([H:22])[c:7]([H:26])[c:13]1[H:32])([c:19]1[c:14]([H:33])[c:8]([H:27])[c:4]([H:23])[c:9]([H:28])[c:15]1[H:34])[c:20]1[c:16]([H:35])[c:10]([H:29])[c:5]([H:24])[c:11]([H:30])[c:17]1[H:36]
    [Br:1][S:4][c:16]1[c:13]([H:25])[c:9]([H:21])[c:8]([H:20])[c:12]([H:24])[c:15]1/[N:3]=[N:2]/[c:14]1[c:10]([H:22])[c:6]([H:18])[c:5]([H:17])[c:7]([H:19])[c:11]1[H:23]
    [I:1][P:13]([S:2][C:6]([H:14])([H:15])[H:16])([N:3]([C:7]([H:17])([H:18])[H:19])[C:8]([H:20])([H:21])[H:22])([N:4]([C:9]([H:23])([H:24])[H:25])[C:10]([H:26])([H:27])[H:28])[N:5]([C:11]([H:29])([H:30])[H:31])[C:12]([H:32])([H:33])[H:34]
    [H:11][C:4]([H:12])([H:13])[S:7]([C:5]([H:14])([H:15])[H:16])([C:6]([H:17])([H:18])[C:3]([H:9])([H:10])[O:2][H:8])[I:1]
    [P:1]#[C:2][c:8]1[c:6]([H:12])[c:4]([H:10])[c:3]([H:9])[c:5]([H:11])[c:7]1[H:13]
2025-09-12 12:32:26.827 | INFO     | __main__:main:100 - Loading test dataset(s)
2025-09-12 12:32:26.832 | INFO     | __main__:main:105 - Checking test dataset(s)
2025-09-12 12:32:26.901 | WARNING  | __main__:remove_missing_rows:140 - Skipping some SMILES because their topologies do not exist:
    [S:3]([S:4][Br:2])[Br:1]
    [S:3]([S:4][I:2])[I:1]
2025-09-12 12:32:26.911 | INFO     | __main__:main:110 - Training config: {'attributes': {},
 'parameters': {'Angles': {'cols': ['k', 'angle'],
                           'limits': {'angle': [0.0, 3.141592653589793],
                                      'k': [0.0, None]},
                           'scales': {'angle': 1.0, 'k': 0.01}},
                'Bonds': {'cols': ['k', 'length'],
                          'limits': {'k': [0.0, None], 'length': [0.0, None]},
                          'scales': {'k': 0.01, 'length': 1.0}},
                'ProperTorsions': {'cols': ['k'],
                                   'limits': {'k': [0.0, None]},
                                   'scales': {'k': 0.01}}}}
2025-09-12 12:32:26.911 | INFO     | __main__:train_force_field:199 - torch.cuda.is_available()=True
2025-09-12 12:32:26.911 | INFO     | __main__:train_force_field:204 - Training on cuda
2025-09-12 12:32:35.631 | INFO     | __main__:train_force_field:219 - Start training...
2025-09-12 12:32:35.632 | INFO     | __main__:train_force_field:228 - Beginning first epoch
2025-09-12 12:34:48.459 | ERROR    | __main__:<module>:332 - An error has been caught in function '<module>', process 'MainProcess' (37437), thread 'MainThread' (139892823627392):
Traceback (most recent call last):

> File "/home/joshmitchell/Documents/openff/back-to-school-josh/workflow/05-fit/fit.py", line 333, in <module>
    app()
    └ App(name=('fit',), help='\nTODO: Write me!\n\n**Input files:**\n\nFile 1\n    File 1 description\n\nFile 2\n    File 2 descri...

  File "/home/joshmitchell/Documents/openff/back-to-school-josh/.rocm-env/lib/python3.11/site-packages/cyclopts/core.py", line 1393, in __call__
    return _run_maybe_async_command(command, bound, backend)
           │                        │        │      └ 'asyncio'
           │                        │        └ <BoundArguments (tensor_ff_path=PosixPath('../04-parametrize/outputs/tensor_ff.pt'), tensor_tops_path=PosixPath('../04-parame...
           │                        └ <function main at 0x7f3b55d98680>
           └ <function _run_maybe_async_command at 0x7f387e5993a0>
  File "/home/joshmitchell/Documents/openff/back-to-school-josh/.rocm-env/lib/python3.11/site-packages/cyclopts/core.py", line 186, in _run_maybe_async_command
    return command(*bound.args, **bound.kwargs)
           │        │     │       │     └ <property object at 0x7f3b55736e30>
           │        │     │       └ <BoundArguments (tensor_ff_path=PosixPath('../04-parametrize/outputs/tensor_ff.pt'), tensor_tops_path=PosixPath('../04-parame...
           │        │     └ <property object at 0x7f3b55736de0>
           │        └ <BoundArguments (tensor_ff_path=PosixPath('../04-parametrize/outputs/tensor_ff.pt'), tensor_tops_path=PosixPath('../04-parame...
           └ <function main at 0x7f3b55d98680>

  File "/home/joshmitchell/Documents/openff/back-to-school-josh/workflow/05-fit/fit.py", line 112, in main
    train_force_field(
    └ <function train_force_field at 0x7f387e9e1620>

  File "/home/joshmitchell/Documents/openff/back-to-school-josh/workflow/05-fit/fit.py", line 248, in train_force_field
    e_ref, e_pred, f_ref, f_pred = descent.targets.energy.predict(
                                   │       │       │      └ <function predict at 0x7f3b288b9940>
                                   │       │       └ <module 'descent.targets.energy' from '/home/joshmitchell/Documents/openff/back-to-school-josh/.rocm-env/lib/python3.11/site-...
                                   │       └ <module 'descent.targets' from '/home/joshmitchell/Documents/openff/back-to-school-josh/.rocm-env/lib/python3.11/site-package...
                                   └ <module 'descent' from '/home/joshmitchell/Documents/openff/back-to-school-josh/.rocm-env/lib/python3.11/site-packages/descen...

  File "/home/joshmitchell/Documents/openff/back-to-school-josh/.rocm-env/lib/python3.11/site-packages/descent/targets/energy.py", line 121, in predict
    energy_pred = smee.compute_energy(topology, force_field, coords)
                  │    │              │         │            └ tensor([[[-9.7179e-01,  1.8268e+00,  1.5363e-01],
                  │    │              │         │                       [ 9.1550e-02, -1.2286e+00,  9.0972e-02],
                  │    │              │         │                       [-2.1145e-01,  4...
                  │    │              │         └ TensorForceField(potentials=[TensorPotential(type='Angles', fn='k/2*(theta-angle)**2', parameters=tensor([[275.1660,   1.7158...
                  │    │              └ TensorTopology(atomic_nums=tensor([17, 16, 16,  1]), formal_charges=tensor([0, 0, 0, 0]), bond_idxs=tensor([[0, 2],
                  │    │                        [...
                  │    └ <function compute_energy at 0x7f387ec43560>
                  └ <module 'smee' from '/home/joshmitchell/Documents/openff/back-to-school-josh/.rocm-env/lib/python3.11/site-packages/smee/__in...
  File "/home/joshmitchell/Documents/openff/back-to-school-josh/.rocm-env/lib/python3.11/site-packages/smee/potentials/_potentials.py", line 364, in compute_energy
    energy += compute_energy_potential(
    │         └ <function compute_energy_potential at 0x7f387ec43420>
    └ tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
              0., 0., 0., 0...
  File "/home/joshmitchell/Documents/openff/back-to-school-josh/.rocm-env/lib/python3.11/site-packages/smee/potentials/_potentials.py", line 328, in compute_energy_potential
    return energy_fn(system, potential, conformer, **energy_fn_kwargs)
           │         │       │          │            └ {}
           │         │       │          └ tensor([[[-9.7179e-01,  1.8268e+00,  1.5363e-01],
           │         │       │                     [ 9.1550e-02, -1.2286e+00,  9.0972e-02],
           │         │       │                     [-2.1145e-01,  4...
           │         │       └ TensorPotential(type='Angles', fn='k/2*(theta-angle)**2', parameters=tensor([[275.1660,   1.7158],
           │         │                 [133.0182,   1.918...
           │         └ TensorSystem(topologies=[TensorTopology(atomic_nums=tensor([17, 16, 16,  1]), formal_charges=tensor([0, 0, 0, 0]), bond_idxs=...
           └ <function compute_harmonic_angle_energy at 0x7f387794ca40>
  File "/home/joshmitchell/Documents/openff/back-to-school-josh/.rocm-env/lib/python3.11/site-packages/smee/potentials/valence.py", line 66, in compute_harmonic_angle_energy
    theta = smee.geometry.compute_angles(conformer, particle_idxs)
            │    │        │              │          └ tensor([[0, 2, 1],
            │    │        │              │                    [2, 1, 3]], device='cuda:0')
            │    │        │              └ tensor([[[-9.7179e-01,  1.8268e+00,  1.5363e-01],
            │    │        │                         [ 9.1550e-02, -1.2286e+00,  9.0972e-02],
            │    │        │                         [-2.1145e-01,  4...
            │    │        └ <function compute_angles at 0x7f38d8a35a80>
            │    └ <module 'smee.geometry' from '/home/joshmitchell/Documents/openff/back-to-school-josh/.rocm-env/lib/python3.11/site-packages/...
            └ <module 'smee' from '/home/joshmitchell/Documents/openff/back-to-school-josh/.rocm-env/lib/python3.11/site-packages/smee/__in...
  File "/home/joshmitchell/Documents/openff/back-to-school-josh/.rocm-env/lib/python3.11/site-packages/smee/geometry.py", line 93, in compute_angles
    vector_ab = conformer[:, atom_indices[:, 1]] - conformer[:, atom_indices[:, 0]]
                │            │                     │            └ tensor([[0, 2, 1],
                │            │                     │                      [2, 1, 3]], device='cuda:0')
                │            │                     └ tensor([[[-9.7179e-01,  1.8268e+00,  1.5363e-01],
                │            │                                [ 9.1550e-02, -1.2286e+00,  9.0972e-02],
                │            │                                [-2.1145e-01,  4...
                │            └ tensor([[0, 2, 1],
                │                      [2, 1, 3]], device='cuda:0')
                └ tensor([[[-9.7179e-01,  1.8268e+00,  1.5363e-01],
                           [ 9.1550e-02, -1.2286e+00,  9.0972e-02],
                           [-2.1145e-01,  4...

RuntimeError: indices should be either on cpu or on the same device as the indexed tensor (cpu)
2025-09-12 12:40:54.183 | INFO     | __main__:main:80 - ---------------------- starting script ----------------------
2025-09-12 12:40:54.183 | INFO     | __main__:main:82 - Loading tensor force field
2025-09-12 12:40:59.366 | INFO     | __main__:main:85 - Loading tensor topologies
2025-09-12 12:41:23.706 | INFO     | __main__:main:91 - Loading training dataset(s)
2025-09-12 12:41:23.756 | INFO     | __main__:main:96 - Checking training dataset(s)
2025-09-12 12:41:24.995 | WARNING  | __main__:remove_missing_rows:139 - Skipping some SMILES because their topologies do not exist:
    [F:1][P:4]([F:2])[I:3]
    [N:1]#[C:3][S:4][I:2]
    [I:1][P:21]([I:2])([c:18]1[c:12]([H:31])[c:6]([H:25])[c:3]([H:22])[c:7]([H:26])[c:13]1[H:32])([c:19]1[c:14]([H:33])[c:8]([H:27])[c:4]([H:23])[c:9]([H:28])[c:15]1[H:34])[c:20]1[c:16]([H:35])[c:10]([H:29])[c:5]([H:24])[c:11]([H:30])[c:17]1[H:36]
    [Br:1][S:4][c:16]1[c:13]([H:25])[c:9]([H:21])[c:8]([H:20])[c:12]([H:24])[c:15]1/[N:3]=[N:2]/[c:14]1[c:10]([H:22])[c:6]([H:18])[c:5]([H:17])[c:7]([H:19])[c:11]1[H:23]
    [I:1][P:13]([S:2][C:6]([H:14])([H:15])[H:16])([N:3]([C:7]([H:17])([H:18])[H:19])[C:8]([H:20])([H:21])[H:22])([N:4]([C:9]([H:23])([H:24])[H:25])[C:10]([H:26])([H:27])[H:28])[N:5]([C:11]([H:29])([H:30])[H:31])[C:12]([H:32])([H:33])[H:34]
    [H:11][C:4]([H:12])([H:13])[S:7]([C:5]([H:14])([H:15])[H:16])([C:6]([H:17])([H:18])[C:3]([H:9])([H:10])[O:2][H:8])[I:1]
    [P:1]#[C:2][c:8]1[c:6]([H:12])[c:4]([H:10])[c:3]([H:9])[c:5]([H:11])[c:7]1[H:13]
2025-09-12 12:41:25.017 | INFO     | __main__:main:99 - Loading test dataset(s)
2025-09-12 12:41:25.021 | INFO     | __main__:main:104 - Checking test dataset(s)
2025-09-12 12:41:25.087 | WARNING  | __main__:remove_missing_rows:139 - Skipping some SMILES because their topologies do not exist:
    [S:3]([S:4][Br:2])[Br:1]
    [S:3]([S:4][I:2])[I:1]
2025-09-12 12:41:25.098 | INFO     | __main__:main:109 - Training config: {'attributes': {},
 'parameters': {'Angles': {'cols': ['k', 'angle'],
                           'limits': {'angle': [0.0, 3.141592653589793],
                                      'k': [0.0, None]},
                           'scales': {'angle': 1.0, 'k': 0.01}},
                'Bonds': {'cols': ['k', 'length'],
                          'limits': {'k': [0.0, None], 'length': [0.0, None]},
                          'scales': {'k': 0.01, 'length': 1.0}},
                'ProperTorsions': {'cols': ['k'],
                                   'limits': {'k': [0.0, None]},
                                   'scales': {'k': 0.01}}}}
2025-09-12 12:41:25.098 | INFO     | __main__:train_force_field:198 - torch.cuda.is_available()=True
2025-09-12 12:41:25.098 | INFO     | __main__:train_force_field:203 - Training on cuda
2025-09-12 12:41:33.686 | INFO     | __main__:train_force_field:218 - Start training...
2025-09-12 12:41:33.687 | INFO     | __main__:train_force_field:227 - Beginning first epoch
2025-09-12 12:42:27.377 | INFO     | __main__:main:80 - ---------------------- starting script ----------------------
2025-09-12 12:42:27.377 | INFO     | __main__:main:82 - Loading tensor force field
2025-09-12 12:42:32.545 | INFO     | __main__:main:85 - Loading tensor topologies
2025-09-12 12:42:56.949 | INFO     | __main__:main:91 - Loading training dataset(s)
2025-09-12 12:42:56.997 | INFO     | __main__:main:96 - Checking training dataset(s)
2025-09-12 12:42:58.236 | WARNING  | __main__:remove_missing_rows:139 - Skipping some SMILES because their topologies do not exist:
    [F:1][P:4]([F:2])[I:3]
    [N:1]#[C:3][S:4][I:2]
    [I:1][P:21]([I:2])([c:18]1[c:12]([H:31])[c:6]([H:25])[c:3]([H:22])[c:7]([H:26])[c:13]1[H:32])([c:19]1[c:14]([H:33])[c:8]([H:27])[c:4]([H:23])[c:9]([H:28])[c:15]1[H:34])[c:20]1[c:16]([H:35])[c:10]([H:29])[c:5]([H:24])[c:11]([H:30])[c:17]1[H:36]
    [Br:1][S:4][c:16]1[c:13]([H:25])[c:9]([H:21])[c:8]([H:20])[c:12]([H:24])[c:15]1/[N:3]=[N:2]/[c:14]1[c:10]([H:22])[c:6]([H:18])[c:5]([H:17])[c:7]([H:19])[c:11]1[H:23]
    [I:1][P:13]([S:2][C:6]([H:14])([H:15])[H:16])([N:3]([C:7]([H:17])([H:18])[H:19])[C:8]([H:20])([H:21])[H:22])([N:4]([C:9]([H:23])([H:24])[H:25])[C:10]([H:26])([H:27])[H:28])[N:5]([C:11]([H:29])([H:30])[H:31])[C:12]([H:32])([H:33])[H:34]
    [H:11][C:4]([H:12])([H:13])[S:7]([C:5]([H:14])([H:15])[H:16])([C:6]([H:17])([H:18])[C:3]([H:9])([H:10])[O:2][H:8])[I:1]
    [P:1]#[C:2][c:8]1[c:6]([H:12])[c:4]([H:10])[c:3]([H:9])[c:5]([H:11])[c:7]1[H:13]
2025-09-12 12:42:58.257 | INFO     | __main__:main:99 - Loading test dataset(s)
2025-09-12 12:42:58.261 | INFO     | __main__:main:104 - Checking test dataset(s)
2025-09-12 12:42:58.329 | WARNING  | __main__:remove_missing_rows:139 - Skipping some SMILES because their topologies do not exist:
    [S:3]([S:4][Br:2])[Br:1]
    [S:3]([S:4][I:2])[I:1]
2025-09-12 12:42:58.340 | INFO     | __main__:main:109 - Training config: {'attributes': {},
 'parameters': {'Angles': {'cols': ['k', 'angle'],
                           'limits': {'angle': [0.0, 3.141592653589793],
                                      'k': [0.0, None]},
                           'scales': {'angle': 1.0, 'k': 0.01}},
                'Bonds': {'cols': ['k', 'length'],
                          'limits': {'k': [0.0, None], 'length': [0.0, None]},
                          'scales': {'k': 0.01, 'length': 1.0}},
                'ProperTorsions': {'cols': ['k'],
                                   'limits': {'k': [0.0, None]},
                                   'scales': {'k': 0.01}}}}
2025-09-12 12:42:58.340 | INFO     | __main__:train_force_field:198 - torch.cuda.is_available()=True
2025-09-12 12:42:58.340 | INFO     | __main__:train_force_field:203 - Training on cuda
2025-09-12 12:43:07.050 | INFO     | __main__:train_force_field:218 - Start training...
2025-09-12 12:43:07.051 | INFO     | __main__:train_force_field:227 - Beginning first epoch
2025-09-12 12:43:58.749 | INFO     | __main__:main:80 - ---------------------- starting script ----------------------
2025-09-12 12:43:58.749 | INFO     | __main__:main:82 - Loading tensor force field
2025-09-12 12:44:03.922 | INFO     | __main__:main:85 - Loading tensor topologies
2025-09-12 12:44:27.949 | INFO     | __main__:main:91 - Loading training dataset(s)
2025-09-12 12:44:27.997 | INFO     | __main__:main:96 - Checking training dataset(s)
2025-09-12 12:44:29.217 | WARNING  | __main__:remove_missing_rows:140 - Skipping some SMILES because their topologies do not exist:
    [F:1][P:4]([F:2])[I:3]
    [N:1]#[C:3][S:4][I:2]
    [I:1][P:21]([I:2])([c:18]1[c:12]([H:31])[c:6]([H:25])[c:3]([H:22])[c:7]([H:26])[c:13]1[H:32])([c:19]1[c:14]([H:33])[c:8]([H:27])[c:4]([H:23])[c:9]([H:28])[c:15]1[H:34])[c:20]1[c:16]([H:35])[c:10]([H:29])[c:5]([H:24])[c:11]([H:30])[c:17]1[H:36]
    [Br:1][S:4][c:16]1[c:13]([H:25])[c:9]([H:21])[c:8]([H:20])[c:12]([H:24])[c:15]1/[N:3]=[N:2]/[c:14]1[c:10]([H:22])[c:6]([H:18])[c:5]([H:17])[c:7]([H:19])[c:11]1[H:23]
    [I:1][P:13]([S:2][C:6]([H:14])([H:15])[H:16])([N:3]([C:7]([H:17])([H:18])[H:19])[C:8]([H:20])([H:21])[H:22])([N:4]([C:9]([H:23])([H:24])[H:25])[C:10]([H:26])([H:27])[H:28])[N:5]([C:11]([H:29])([H:30])[H:31])[C:12]([H:32])([H:33])[H:34]
    [H:11][C:4]([H:12])([H:13])[S:7]([C:5]([H:14])([H:15])[H:16])([C:6]([H:17])([H:18])[C:3]([H:9])([H:10])[O:2][H:8])[I:1]
    [P:1]#[C:2][c:8]1[c:6]([H:12])[c:4]([H:10])[c:3]([H:9])[c:5]([H:11])[c:7]1[H:13]
2025-09-12 12:44:29.239 | INFO     | __main__:main:99 - Loading test dataset(s)
2025-09-12 12:44:29.243 | INFO     | __main__:main:104 - Checking test dataset(s)
2025-09-12 12:44:29.309 | WARNING  | __main__:remove_missing_rows:140 - Skipping some SMILES because their topologies do not exist:
    [S:3]([S:4][Br:2])[Br:1]
    [S:3]([S:4][I:2])[I:1]
2025-09-12 12:44:29.319 | INFO     | __main__:main:109 - Training config: {'attributes': {},
 'parameters': {'Angles': {'cols': ['k', 'angle'],
                           'limits': {'angle': [0.0, 3.141592653589793],
                                      'k': [0.0, None]},
                           'scales': {'angle': 1.0, 'k': 0.01}},
                'Bonds': {'cols': ['k', 'length'],
                          'limits': {'k': [0.0, None], 'length': [0.0, None]},
                          'scales': {'k': 0.01, 'length': 1.0}},
                'ProperTorsions': {'cols': ['k'],
                                   'limits': {'k': [0.0, None]},
                                   'scales': {'k': 0.01}}}}
2025-09-12 12:44:29.319 | INFO     | __main__:train_force_field:199 - torch.cuda.is_available()=True
2025-09-12 12:44:29.319 | INFO     | __main__:train_force_field:204 - Training on cuda
2025-09-12 12:44:37.982 | INFO     | __main__:train_force_field:219 - Start training...
2025-09-12 12:44:37.984 | INFO     | __main__:train_force_field:228 - Beginning first epoch
2025-09-12 12:46:43.451 | INFO     | __main__:main:80 - ---------------------- starting script ----------------------
2025-09-12 12:46:43.451 | INFO     | __main__:main:82 - Loading tensor force field
2025-09-12 12:46:48.652 | INFO     | __main__:main:85 - Loading tensor topologies
2025-09-12 12:47:12.318 | INFO     | __main__:main:91 - Loading training dataset(s)
2025-09-12 12:47:12.368 | INFO     | __main__:main:96 - Checking training dataset(s)
2025-09-12 12:47:13.654 | WARNING  | __main__:remove_missing_rows:140 - Skipping some SMILES because their topologies do not exist:
    [F:1][P:4]([F:2])[I:3]
    [N:1]#[C:3][S:4][I:2]
    [I:1][P:21]([I:2])([c:18]1[c:12]([H:31])[c:6]([H:25])[c:3]([H:22])[c:7]([H:26])[c:13]1[H:32])([c:19]1[c:14]([H:33])[c:8]([H:27])[c:4]([H:23])[c:9]([H:28])[c:15]1[H:34])[c:20]1[c:16]([H:35])[c:10]([H:29])[c:5]([H:24])[c:11]([H:30])[c:17]1[H:36]
    [Br:1][S:4][c:16]1[c:13]([H:25])[c:9]([H:21])[c:8]([H:20])[c:12]([H:24])[c:15]1/[N:3]=[N:2]/[c:14]1[c:10]([H:22])[c:6]([H:18])[c:5]([H:17])[c:7]([H:19])[c:11]1[H:23]
    [I:1][P:13]([S:2][C:6]([H:14])([H:15])[H:16])([N:3]([C:7]([H:17])([H:18])[H:19])[C:8]([H:20])([H:21])[H:22])([N:4]([C:9]([H:23])([H:24])[H:25])[C:10]([H:26])([H:27])[H:28])[N:5]([C:11]([H:29])([H:30])[H:31])[C:12]([H:32])([H:33])[H:34]
    [H:11][C:4]([H:12])([H:13])[S:7]([C:5]([H:14])([H:15])[H:16])([C:6]([H:17])([H:18])[C:3]([H:9])([H:10])[O:2][H:8])[I:1]
    [P:1]#[C:2][c:8]1[c:6]([H:12])[c:4]([H:10])[c:3]([H:9])[c:5]([H:11])[c:7]1[H:13]
2025-09-12 12:47:13.675 | INFO     | __main__:main:99 - Loading test dataset(s)
2025-09-12 12:47:13.679 | INFO     | __main__:main:104 - Checking test dataset(s)
2025-09-12 12:47:13.746 | WARNING  | __main__:remove_missing_rows:140 - Skipping some SMILES because their topologies do not exist:
    [S:3]([S:4][Br:2])[Br:1]
    [S:3]([S:4][I:2])[I:1]
2025-09-12 12:47:13.756 | INFO     | __main__:main:109 - Training config: {'attributes': {},
 'parameters': {'Angles': {'cols': ['k', 'angle'],
                           'limits': {'angle': [0.0, 3.141592653589793],
                                      'k': [0.0, None]},
                           'scales': {'angle': 1.0, 'k': 0.01}},
                'Bonds': {'cols': ['k', 'length'],
                          'limits': {'k': [0.0, None], 'length': [0.0, None]},
                          'scales': {'k': 0.01, 'length': 1.0}},
                'ProperTorsions': {'cols': ['k'],
                                   'limits': {'k': [0.0, None]},
                                   'scales': {'k': 0.01}}}}
2025-09-12 12:47:13.756 | INFO     | __main__:train_force_field:199 - torch.cuda.is_available()=True
2025-09-12 12:47:13.756 | INFO     | __main__:train_force_field:204 - Training on cuda
2025-09-12 12:47:22.643 | INFO     | __main__:train_force_field:219 - Start training...
2025-09-12 12:47:22.644 | INFO     | __main__:train_force_field:228 - Beginning first epoch
2025-09-12 12:56:32.870 | INFO     | __main__:main:84 - ---------------------- starting script ----------------------
2025-09-12 12:56:32.870 | INFO     | __main__:main:86 - Loading tensor force field
2025-09-12 12:56:38.014 | INFO     | __main__:main:89 - Loading tensor topologies
2025-09-12 13:00:16.699 | INFO     | __main__:main:84 - ---------------------- starting script ----------------------
2025-09-12 13:00:16.699 | INFO     | __main__:main:86 - Loading tensor force field
2025-09-12 13:00:21.904 | INFO     | __main__:main:89 - Loading tensor topologies
2025-09-12 13:00:47.510 | INFO     | __main__:main:95 - Loading training dataset(s)
2025-09-12 13:00:47.569 | INFO     | __main__:main:100 - Checking training dataset(s)
2025-09-12 13:00:48.804 | WARNING  | __main__:remove_missing_rows:145 - Skipping some SMILES because their topologies do not exist:
    [F:1][P:4]([F:2])[I:3]
    [N:1]#[C:3][S:4][I:2]
    [I:1][P:21]([I:2])([c:18]1[c:12]([H:31])[c:6]([H:25])[c:3]([H:22])[c:7]([H:26])[c:13]1[H:32])([c:19]1[c:14]([H:33])[c:8]([H:27])[c:4]([H:23])[c:9]([H:28])[c:15]1[H:34])[c:20]1[c:16]([H:35])[c:10]([H:29])[c:5]([H:24])[c:11]([H:30])[c:17]1[H:36]
    [Br:1][S:4][c:16]1[c:13]([H:25])[c:9]([H:21])[c:8]([H:20])[c:12]([H:24])[c:15]1/[N:3]=[N:2]/[c:14]1[c:10]([H:22])[c:6]([H:18])[c:5]([H:17])[c:7]([H:19])[c:11]1[H:23]
    [I:1][P:13]([S:2][C:6]([H:14])([H:15])[H:16])([N:3]([C:7]([H:17])([H:18])[H:19])[C:8]([H:20])([H:21])[H:22])([N:4]([C:9]([H:23])([H:24])[H:25])[C:10]([H:26])([H:27])[H:28])[N:5]([C:11]([H:29])([H:30])[H:31])[C:12]([H:32])([H:33])[H:34]
    [H:11][C:4]([H:12])([H:13])[S:7]([C:5]([H:14])([H:15])[H:16])([C:6]([H:17])([H:18])[C:3]([H:9])([H:10])[O:2][H:8])[I:1]
    [P:1]#[C:2][c:8]1[c:6]([H:12])[c:4]([H:10])[c:3]([H:9])[c:5]([H:11])[c:7]1[H:13]
2025-09-12 13:00:48.825 | INFO     | __main__:main:103 - Loading test dataset(s)
2025-09-12 13:00:48.830 | INFO     | __main__:main:108 - Checking test dataset(s)
2025-09-12 13:00:48.898 | WARNING  | __main__:remove_missing_rows:145 - Skipping some SMILES because their topologies do not exist:
    [S:3]([S:4][Br:2])[Br:1]
    [S:3]([S:4][I:2])[I:1]
2025-09-12 13:00:48.907 | INFO     | __main__:main:113 - Training config: {'attributes': {},
 'parameters': {'Angles': {'cols': ['k', 'angle'],
                           'limits': {'angle': [0.0, 3.141592653589793],
                                      'k': [0.0, None]},
                           'scales': {'angle': 1.0, 'k': 0.01}},
                'Bonds': {'cols': ['k', 'length'],
                          'limits': {'k': [0.0, None], 'length': [0.0, None]},
                          'scales': {'k': 0.01, 'length': 1.0}},
                'ProperTorsions': {'cols': ['k'],
                                   'limits': {'k': [0.0, None]},
                                   'scales': {'k': 0.01}}}}
2025-09-12 13:00:48.908 | INFO     | __main__:train_force_field:205 - torch.cuda.is_available()=True
2025-09-12 13:00:48.908 | INFO     | __main__:train_force_field:211 - Training on cpu (NB: AMD ROCm here appears as 'cuda')
2025-09-12 13:00:49.285 | INFO     | __main__:train_force_field:228 - Start training...
2025-09-12 13:00:49.287 | INFO     | __main__:train_force_field:237 - Beginning first epoch
2025-09-12 13:01:47.222 | INFO     | __main__:main:84 - ---------------------- starting script ----------------------
2025-09-12 13:01:47.222 | INFO     | __main__:main:86 - Loading tensor force field
2025-09-12 13:01:52.468 | INFO     | __main__:main:89 - Loading tensor topologies
2025-09-12 13:02:16.816 | INFO     | __main__:main:95 - Loading training dataset(s)
2025-09-12 13:02:16.866 | INFO     | __main__:main:100 - Checking training dataset(s)
2025-09-12 13:02:18.074 | WARNING  | __main__:remove_missing_rows:145 - Skipping some SMILES because their topologies do not exist:
    [F:1][P:4]([F:2])[I:3]
    [N:1]#[C:3][S:4][I:2]
    [I:1][P:21]([I:2])([c:18]1[c:12]([H:31])[c:6]([H:25])[c:3]([H:22])[c:7]([H:26])[c:13]1[H:32])([c:19]1[c:14]([H:33])[c:8]([H:27])[c:4]([H:23])[c:9]([H:28])[c:15]1[H:34])[c:20]1[c:16]([H:35])[c:10]([H:29])[c:5]([H:24])[c:11]([H:30])[c:17]1[H:36]
    [Br:1][S:4][c:16]1[c:13]([H:25])[c:9]([H:21])[c:8]([H:20])[c:12]([H:24])[c:15]1/[N:3]=[N:2]/[c:14]1[c:10]([H:22])[c:6]([H:18])[c:5]([H:17])[c:7]([H:19])[c:11]1[H:23]
    [I:1][P:13]([S:2][C:6]([H:14])([H:15])[H:16])([N:3]([C:7]([H:17])([H:18])[H:19])[C:8]([H:20])([H:21])[H:22])([N:4]([C:9]([H:23])([H:24])[H:25])[C:10]([H:26])([H:27])[H:28])[N:5]([C:11]([H:29])([H:30])[H:31])[C:12]([H:32])([H:33])[H:34]
    [H:11][C:4]([H:12])([H:13])[S:7]([C:5]([H:14])([H:15])[H:16])([C:6]([H:17])([H:18])[C:3]([H:9])([H:10])[O:2][H:8])[I:1]
    [P:1]#[C:2][c:8]1[c:6]([H:12])[c:4]([H:10])[c:3]([H:9])[c:5]([H:11])[c:7]1[H:13]
2025-09-12 13:02:18.095 | INFO     | __main__:main:103 - Loading test dataset(s)
2025-09-12 13:02:18.100 | INFO     | __main__:main:108 - Checking test dataset(s)
2025-09-12 13:02:18.168 | WARNING  | __main__:remove_missing_rows:145 - Skipping some SMILES because their topologies do not exist:
    [S:3]([S:4][Br:2])[Br:1]
    [S:3]([S:4][I:2])[I:1]
2025-09-12 13:02:18.177 | INFO     | __main__:main:113 - Training config: {'attributes': {},
 'parameters': {'Angles': {'cols': ['k', 'angle'],
                           'limits': {'angle': [0.0, 3.141592653589793],
                                      'k': [0.0, None]},
                           'scales': {'angle': 1.0, 'k': 0.01}},
                'Bonds': {'cols': ['k', 'length'],
                          'limits': {'k': [0.0, None], 'length': [0.0, None]},
                          'scales': {'k': 0.01, 'length': 1.0}},
                'ProperTorsions': {'cols': ['k'],
                                   'limits': {'k': [0.0, None]},
                                   'scales': {'k': 0.01}}}}
2025-09-12 13:02:18.178 | INFO     | __main__:train_force_field:205 - torch.cuda.is_available()=True
2025-09-12 13:02:18.178 | INFO     | __main__:train_force_field:211 - Training on cuda (NB: AMD ROCm here appears as 'cuda')
2025-09-12 13:02:18.178 | INFO     | __main__:train_force_field:213 - First available cuda device: AMD Radeon RX 7900 XTX
2025-09-12 13:02:26.914 | INFO     | __main__:train_force_field:228 - Start training...
2025-09-12 13:02:26.915 | INFO     | __main__:train_force_field:237 - Beginning first epoch
2025-09-12 13:06:47.193 | INFO     | __main__:main:83 - ---------------------- starting script ----------------------
2025-09-12 13:06:47.193 | INFO     | __main__:main:85 - Loading tensor force field
2025-09-12 13:06:52.398 | INFO     | __main__:main:88 - Loading tensor topologies
2025-09-12 13:07:16.183 | INFO     | __main__:main:94 - Loading training dataset(s)
2025-09-12 13:07:16.230 | INFO     | __main__:main:99 - Checking training dataset(s)
2025-09-12 13:07:17.421 | WARNING  | __main__:remove_missing_rows:144 - Skipping some SMILES because their topologies do not exist:
    [F:1][P:4]([F:2])[I:3]
    [N:1]#[C:3][S:4][I:2]
    [I:1][P:21]([I:2])([c:18]1[c:12]([H:31])[c:6]([H:25])[c:3]([H:22])[c:7]([H:26])[c:13]1[H:32])([c:19]1[c:14]([H:33])[c:8]([H:27])[c:4]([H:23])[c:9]([H:28])[c:15]1[H:34])[c:20]1[c:16]([H:35])[c:10]([H:29])[c:5]([H:24])[c:11]([H:30])[c:17]1[H:36]
    [Br:1][S:4][c:16]1[c:13]([H:25])[c:9]([H:21])[c:8]([H:20])[c:12]([H:24])[c:15]1/[N:3]=[N:2]/[c:14]1[c:10]([H:22])[c:6]([H:18])[c:5]([H:17])[c:7]([H:19])[c:11]1[H:23]
    [I:1][P:13]([S:2][C:6]([H:14])([H:15])[H:16])([N:3]([C:7]([H:17])([H:18])[H:19])[C:8]([H:20])([H:21])[H:22])([N:4]([C:9]([H:23])([H:24])[H:25])[C:10]([H:26])([H:27])[H:28])[N:5]([C:11]([H:29])([H:30])[H:31])[C:12]([H:32])([H:33])[H:34]
    [H:11][C:4]([H:12])([H:13])[S:7]([C:5]([H:14])([H:15])[H:16])([C:6]([H:17])([H:18])[C:3]([H:9])([H:10])[O:2][H:8])[I:1]
    [P:1]#[C:2][c:8]1[c:6]([H:12])[c:4]([H:10])[c:3]([H:9])[c:5]([H:11])[c:7]1[H:13]
2025-09-12 13:07:17.442 | INFO     | __main__:main:102 - Loading test dataset(s)
2025-09-12 13:07:17.446 | INFO     | __main__:main:107 - Checking test dataset(s)
2025-09-12 13:07:17.512 | WARNING  | __main__:remove_missing_rows:144 - Skipping some SMILES because their topologies do not exist:
    [S:3]([S:4][Br:2])[Br:1]
    [S:3]([S:4][I:2])[I:1]
2025-09-12 13:07:17.522 | INFO     | __main__:main:112 - Training config: {'attributes': {},
 'parameters': {'Angles': {'cols': ['k', 'angle'],
                           'limits': {'angle': [0.0, 3.141592653589793],
                                      'k': [0.0, None]},
                           'scales': {'angle': 1.0, 'k': 0.01}},
                'Bonds': {'cols': ['k', 'length'],
                          'limits': {'k': [0.0, None], 'length': [0.0, None]},
                          'scales': {'k': 0.01, 'length': 1.0}},
                'ProperTorsions': {'cols': ['k'],
                                   'limits': {'k': [0.0, None]},
                                   'scales': {'k': 0.01}}}}
2025-09-12 13:07:17.522 | INFO     | __main__:train_force_field:204 - torch.cuda.is_available()=True
2025-09-12 13:07:17.522 | INFO     | __main__:train_force_field:210 - Training on cuda (NB: AMD ROCm here appears as 'cuda')
2025-09-12 13:07:17.523 | INFO     | __main__:train_force_field:212 - First available cuda device: AMD Radeon RX 7900 XTX
2025-09-12 13:07:26.215 | INFO     | __main__:train_force_field:227 - Start training...
2025-09-12 13:07:26.217 | INFO     | __main__:train_force_field:236 - Beginning first epoch
2025-09-12 13:10:25.666 | INFO     | __main__:main:83 - ---------------------- starting script ----------------------
2025-09-12 13:10:25.667 | INFO     | __main__:main:85 - Loading tensor force field
2025-09-12 13:10:30.907 | INFO     | __main__:main:88 - Loading tensor topologies
2025-09-12 13:10:55.334 | INFO     | __main__:main:94 - Loading training dataset(s)
2025-09-12 13:10:55.384 | INFO     | __main__:main:99 - Checking training dataset(s)
2025-09-12 13:10:56.606 | WARNING  | __main__:remove_missing_rows:144 - Skipping some SMILES because their topologies do not exist:
    [F:1][P:4]([F:2])[I:3]
    [N:1]#[C:3][S:4][I:2]
    [I:1][P:21]([I:2])([c:18]1[c:12]([H:31])[c:6]([H:25])[c:3]([H:22])[c:7]([H:26])[c:13]1[H:32])([c:19]1[c:14]([H:33])[c:8]([H:27])[c:4]([H:23])[c:9]([H:28])[c:15]1[H:34])[c:20]1[c:16]([H:35])[c:10]([H:29])[c:5]([H:24])[c:11]([H:30])[c:17]1[H:36]
    [Br:1][S:4][c:16]1[c:13]([H:25])[c:9]([H:21])[c:8]([H:20])[c:12]([H:24])[c:15]1/[N:3]=[N:2]/[c:14]1[c:10]([H:22])[c:6]([H:18])[c:5]([H:17])[c:7]([H:19])[c:11]1[H:23]
    [I:1][P:13]([S:2][C:6]([H:14])([H:15])[H:16])([N:3]([C:7]([H:17])([H:18])[H:19])[C:8]([H:20])([H:21])[H:22])([N:4]([C:9]([H:23])([H:24])[H:25])[C:10]([H:26])([H:27])[H:28])[N:5]([C:11]([H:29])([H:30])[H:31])[C:12]([H:32])([H:33])[H:34]
    [H:11][C:4]([H:12])([H:13])[S:7]([C:5]([H:14])([H:15])[H:16])([C:6]([H:17])([H:18])[C:3]([H:9])([H:10])[O:2][H:8])[I:1]
    [P:1]#[C:2][c:8]1[c:6]([H:12])[c:4]([H:10])[c:3]([H:9])[c:5]([H:11])[c:7]1[H:13]
2025-09-12 13:10:56.627 | INFO     | __main__:main:102 - Loading test dataset(s)
2025-09-12 13:10:56.631 | INFO     | __main__:main:107 - Checking test dataset(s)
2025-09-12 13:10:56.697 | WARNING  | __main__:remove_missing_rows:144 - Skipping some SMILES because their topologies do not exist:
    [S:3]([S:4][Br:2])[Br:1]
    [S:3]([S:4][I:2])[I:1]
2025-09-12 13:10:56.708 | INFO     | __main__:main:112 - Training config: {'attributes': {},
 'parameters': {'Angles': {'cols': ['k', 'angle'],
                           'limits': {'angle': [0.0, 3.141592653589793],
                                      'k': [0.0, None]},
                           'scales': {'angle': 1.0, 'k': 0.01}},
                'Bonds': {'cols': ['k', 'length'],
                          'limits': {'k': [0.0, None], 'length': [0.0, None]},
                          'scales': {'k': 0.01, 'length': 1.0}},
                'ProperTorsions': {'cols': ['k'],
                                   'limits': {'k': [0.0, None]},
                                   'scales': {'k': 0.01}}}}
2025-09-12 13:10:56.708 | INFO     | __main__:train_force_field:204 - torch.cuda.is_available()=True
2025-09-12 13:10:56.708 | INFO     | __main__:train_force_field:210 - Training on cpu (NB: AMD ROCm here appears as 'cuda')
2025-09-12 13:10:57.044 | INFO     | __main__:train_force_field:227 - Start training...
2025-09-12 13:10:57.046 | INFO     | __main__:train_force_field:236 - Beginning first epoch
2025-09-12 13:36:19.051 | INFO     | __main__:main:83 - ---------------------- starting script ----------------------
2025-09-12 13:36:19.051 | INFO     | __main__:main:85 - Loading tensor force field
2025-09-12 13:36:24.301 | INFO     | __main__:main:88 - Loading tensor topologies
2025-09-12 13:36:49.265 | INFO     | __main__:main:94 - Loading training dataset(s)
2025-09-12 13:36:49.316 | INFO     | __main__:main:99 - Checking training dataset(s)
2025-09-12 13:36:50.551 | WARNING  | __main__:remove_missing_rows:144 - Skipping some SMILES because their topologies do not exist:
    [F:1][P:4]([F:2])[I:3]
    [N:1]#[C:3][S:4][I:2]
    [I:1][P:21]([I:2])([c:18]1[c:12]([H:31])[c:6]([H:25])[c:3]([H:22])[c:7]([H:26])[c:13]1[H:32])([c:19]1[c:14]([H:33])[c:8]([H:27])[c:4]([H:23])[c:9]([H:28])[c:15]1[H:34])[c:20]1[c:16]([H:35])[c:10]([H:29])[c:5]([H:24])[c:11]([H:30])[c:17]1[H:36]
    [Br:1][S:4][c:16]1[c:13]([H:25])[c:9]([H:21])[c:8]([H:20])[c:12]([H:24])[c:15]1/[N:3]=[N:2]/[c:14]1[c:10]([H:22])[c:6]([H:18])[c:5]([H:17])[c:7]([H:19])[c:11]1[H:23]
    [I:1][P:13]([S:2][C:6]([H:14])([H:15])[H:16])([N:3]([C:7]([H:17])([H:18])[H:19])[C:8]([H:20])([H:21])[H:22])([N:4]([C:9]([H:23])([H:24])[H:25])[C:10]([H:26])([H:27])[H:28])[N:5]([C:11]([H:29])([H:30])[H:31])[C:12]([H:32])([H:33])[H:34]
    [H:11][C:4]([H:12])([H:13])[S:7]([C:5]([H:14])([H:15])[H:16])([C:6]([H:17])([H:18])[C:3]([H:9])([H:10])[O:2][H:8])[I:1]
    [P:1]#[C:2][c:8]1[c:6]([H:12])[c:4]([H:10])[c:3]([H:9])[c:5]([H:11])[c:7]1[H:13]
2025-09-12 13:36:50.572 | INFO     | __main__:main:102 - Loading test dataset(s)
2025-09-12 13:36:50.577 | INFO     | __main__:main:107 - Checking test dataset(s)
2025-09-12 13:36:50.642 | WARNING  | __main__:remove_missing_rows:144 - Skipping some SMILES because their topologies do not exist:
    [S:3]([S:4][Br:2])[Br:1]
    [S:3]([S:4][I:2])[I:1]
2025-09-12 13:36:50.652 | INFO     | __main__:main:112 - Training config: {'attributes': {},
 'parameters': {'Angles': {'cols': ['k', 'angle'],
                           'limits': {'angle': [0.0, 3.141592653589793],
                                      'k': [0.0, None]},
                           'scales': {'angle': 1.0, 'k': 0.01}},
                'Bonds': {'cols': ['k', 'length'],
                          'limits': {'k': [0.0, None], 'length': [0.0, None]},
                          'scales': {'k': 0.01, 'length': 1.0}},
                'ProperTorsions': {'cols': ['k'],
                                   'limits': {'k': [0.0, None]},
                                   'scales': {'k': 0.01}}}}
2025-09-12 13:36:50.653 | INFO     | __main__:train_force_field:204 - torch.cuda.is_available()=True
2025-09-12 13:36:50.653 | INFO     | __main__:train_force_field:210 - Training on cuda
2025-09-12 13:36:50.653 | INFO     | __main__:train_force_field:212 - NB: AMD GPUs using ROCm also appear as cuda
2025-09-12 13:36:50.653 | INFO     | __main__:train_force_field:213 - First available cuda/ROCm device: AMD Radeon RX 7900 XTX
2025-09-12 13:37:00.256 | INFO     | __main__:train_force_field:230 - Start training...
2025-09-12 13:37:00.257 | INFO     | __main__:train_force_field:239 - Beginning first epoch
2025-09-12 13:51:35.585 | INFO     | __main__:main:83 - ---------------------- starting script ----------------------
2025-09-12 13:51:35.586 | INFO     | __main__:main:85 - Loading tensor force field
2025-09-12 13:51:48.908 | INFO     | __main__:main:83 - ---------------------- starting script ----------------------
2025-09-12 13:51:48.908 | INFO     | __main__:main:85 - Loading tensor force field
2025-09-12 13:51:54.114 | INFO     | __main__:main:88 - Loading tensor topologies
2025-09-12 13:52:27.306 | INFO     | __main__:main:94 - Loading training dataset(s)
2025-09-12 13:52:27.405 | INFO     | __main__:main:99 - Checking training dataset(s)
2025-09-12 13:52:28.615 | WARNING  | __main__:remove_missing_rows:144 - Skipping some SMILES because their topologies do not exist:
    [F:1][P:4]([F:2])[I:3]
    [N:1]#[C:3][S:4][I:2]
    [I:1][P:21]([I:2])([c:18]1[c:12]([H:31])[c:6]([H:25])[c:3]([H:22])[c:7]([H:26])[c:13]1[H:32])([c:19]1[c:14]([H:33])[c:8]([H:27])[c:4]([H:23])[c:9]([H:28])[c:15]1[H:34])[c:20]1[c:16]([H:35])[c:10]([H:29])[c:5]([H:24])[c:11]([H:30])[c:17]1[H:36]
    [Br:1][S:4][c:16]1[c:13]([H:25])[c:9]([H:21])[c:8]([H:20])[c:12]([H:24])[c:15]1/[N:3]=[N:2]/[c:14]1[c:10]([H:22])[c:6]([H:18])[c:5]([H:17])[c:7]([H:19])[c:11]1[H:23]
    [I:1][P:13]([S:2][C:6]([H:14])([H:15])[H:16])([N:3]([C:7]([H:17])([H:18])[H:19])[C:8]([H:20])([H:21])[H:22])([N:4]([C:9]([H:23])([H:24])[H:25])[C:10]([H:26])([H:27])[H:28])[N:5]([C:11]([H:29])([H:30])[H:31])[C:12]([H:32])([H:33])[H:34]
    [H:11][C:4]([H:12])([H:13])[S:7]([C:5]([H:14])([H:15])[H:16])([C:6]([H:17])([H:18])[C:3]([H:9])([H:10])[O:2][H:8])[I:1]
    [P:1]#[C:2][c:8]1[c:6]([H:12])[c:4]([H:10])[c:3]([H:9])[c:5]([H:11])[c:7]1[H:13]
2025-09-12 13:52:28.639 | INFO     | __main__:main:102 - Loading test dataset(s)
2025-09-12 13:52:28.644 | INFO     | __main__:main:107 - Checking test dataset(s)
2025-09-12 13:52:28.711 | WARNING  | __main__:remove_missing_rows:144 - Skipping some SMILES because their topologies do not exist:
    [S:3]([S:4][Br:2])[Br:1]
    [S:3]([S:4][I:2])[I:1]
2025-09-12 13:52:28.721 | INFO     | __main__:main:112 - Training config: {'attributes': {},
 'parameters': {'Angles': {'cols': ['k', 'angle'],
                           'limits': {'angle': [0.0, 3.141592653589793],
                                      'k': [0.0, None]},
                           'scales': {'angle': 1.0, 'k': 0.01}},
                'Bonds': {'cols': ['k', 'length'],
                          'limits': {'k': [0.0, None], 'length': [0.0, None]},
                          'scales': {'k': 0.01, 'length': 1.0}},
                'ProperTorsions': {'cols': ['k'],
                                   'limits': {'k': [0.0, None]},
                                   'scales': {'k': 0.01}}}}
2025-09-12 13:52:28.724 | INFO     | __main__:train_force_field:204 - torch.cuda.is_available()=True
2025-09-12 13:52:28.724 | INFO     | __main__:train_force_field:210 - Training on cuda
2025-09-12 13:52:28.724 | INFO     | __main__:train_force_field:212 - NB: AMD GPUs using ROCm also appear as cuda
2025-09-12 13:52:28.725 | INFO     | __main__:train_force_field:213 - First available cuda/ROCm device: AMD Radeon RX 7900 XTX
2025-09-12 13:52:37.769 | INFO     | __main__:train_force_field:230 - Start training...
2025-09-12 13:52:37.771 | INFO     | __main__:train_force_field:239 - Beginning first epoch
